!function(t){if(!t.preview){t.assetContainers.main.isExpandable=!0;try{var e=!!window.frameElement,n=e?window.frameElement.parentNode.firstChild.firstChild.contentWindow:window;t.overrides=t.overrides||{},t.overrides.displayWindowTarget=n}catch(t){console.warn("Failed to find target iframe in player environment: Has the structure changed?\n",t)}}var i=!1;if(!t.overrides||t.overrides.displayWindowTarget!=self)for(var a in t.assetContainers)if(t.assetContainers.hasOwnProperty(a)){var o=t.assetContainers[a];if("inlineDiv"!=o.type||o.isExpandable){i=!0;break}}if(t.overrides&&t.overrides.displayWindowTarget){var d=t.overrides.displayWindowTarget;d="undefined"!=typeof adtechIframeHashArray&&self!=top?d.parent:d}else{for(var r=null,s=parent;void 0!=s;){try{var c=s.document;c&&(r=s)}catch(t){}s=s==top?null:s.parent}var d=r||top}var h=!1;try{var c=d.document;c&&(h=!0)}catch(t){}var l=i&&self!=top&&h?d:self;l.com=l.com||{},l.com.adtech=l.com.adtech||{},l.com.adtech.AdtechCustomAd$AD_ID$=function(){};var v=l.com.adtech.AdtechCustomAd$AD_ID$;v.prototype.elem={},v.prototype.elem.topWin=window.parent,v.prototype.elem.targetWindow=l,v.prototype.tools={events:{triggerEvent:function(t,e){var n;document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):document.createEventObject&&(n=document.createEventObject(),n.eventType=e),n.eventName=e,t.dispatchEvent?t.dispatchEvent(n):t.fireEvent&&htmlEvents["on"+e]?t.fireEvent("on"+n.eventType,n):t[e]?t[e]():t["on"+e]&&t["on"+e]()},addEvent:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&htmlEvents["on"+e]?t.attachEvent("on"+e,n):t["on"+e]=n},removeEvent:function(t,e,n){t.removeventListener?t.removeEventListener(e,n,!1):t.detachEvent&&htmlEvents["on"+e]?t.detachEvent("on"+e,n):t["on"+e]=null}},mask:function(t,e){},getPercentage:function(t,e){return t/100*e},getSizeStyle:function(t,e){var n=(this.tools,{}),i=parseInt(t,10),t=t.split(i)[1];return data={num:isNaN(parseFloat(i))?0:i,val:void 0!==t?t:"px"},"%"==data.val?(n.px=Math.round(e/100*data.num),n.percent=data.num):(n.px=data.num,n.percent=data.num/e*100),n},getViewportSize:function(t){if(t=t||window,null!=t.innerWidth)return{w:t.innerWidth,h:t.innerHeight};var e=t.document;return"CSS1Compat"==document.compatMode?{w:e.documentElement.clientWidth,h:e.documentElement.clientHeight}:{w:e.body.clientWidth,h:e.body.clientHeight}}},v.prototype.declareEvents=function(t){ADTECH.event("RYOT_PARENT_META"),ADTECH.event("RYOT_RESIZE"),ADTECH.event("RYOT_FILLWIDTH"),ADTECH.event("RYOT_CHILD_META"),ADTECH.event("RYOT_CHILD_RESIZE")},v.prototype.preInit=function(){null!=window&&(window.com=com||{},com.adtech=window.com.adtech)},v.prototype.init=function(t){this.advert=t,this.elem.adContainer=t.assetContainers.main.anchorDiv,this.elem.adContent=t.assetContainers.main.anchorDiv.firstChild,this.elem.adIframe=this.elem.adContent.getElementsByTagName("iframe")[0],this.elem.adBody=document||this.elem.adIframe.contentWindow.document,this.lib={},this.lib.utils=l.com.adtech.Utils_$VERSION$,this.lib.globalEventBus=l.adtechAdManager_$VERSION$.globalEventBus,this.lib.richMediaEvent=l.com.adtech.RichMediaEvent_$VERSION$,this.metaData={},this.recieveMeta()},v.prototype.data={topPosition:0,scrollTop:0,winWidth:0,winHeight:0,docHeight:0},v.prototype.whenReady=function(){this.handleParentData(),this.sendMeta()},v.prototype.handleParentData=function(){this.setupScrollData(),this.getAdWrapperPosition(),this.setAdHeight(),this.setupResize()},v.prototype.dispatchEvent=function(t,e){var n=new this.lib.richMediaEvent(t),e=e||{};n.meta=e,this.advert.eventBus.dispatchEvent(n)},v.prototype.sendMeta=function(){var t=this;setInterval(function(){t.dispatchEvent("RYOT_PARENT_META",t.data)},100)},v.prototype.recieveMeta=function(){var t=this;this.advert.eventBus.addEventListener("RYOT_CHILD_META",function(e){t.data.docHeight=e.meta.docHeight,t.setAdHeight(e.meta.docHeight,!0),t.whenReady()}),this.advert.eventBus.addEventListener("RYOT_FILLWIDTH",function(e){t.setAdToFillContainer(),t.setAdHeight(t.data.docHeight)})},v.prototype.getAdWrapperPosition=function(){var t=this.elem.adContainer,e=document.body.getBoundingClientRect(),n=t.getBoundingClientRect(),i=n.top-e.top;this.data.topPosition=i},v.prototype.setupScrollData=function(){function t(){var t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}function e(e){n.data.scrollTop=t()}var n=this;window.addEventListener("scroll",e,!1);t(),(new Date).getTime();this.data.scrollTop=t()},v.prototype.setupResize=function(){var t=this,e=t.getWindowSize();t.data.winWidth=e.width,t.data.winHeight=e.height,window.addEventListener("resize",function(){t.dispatchEvent("RYOT_RESIZE",t.data)},!0),this.advert.eventBus.addEventListener("RYOT_CHILD_RESIZE",function(e){var n=t.getWindowSize();t.data.winWidth=n.width,t.data.winHeight=n.height,t.setAdHeight(e.meta.docHeight)})},v.prototype.getWindowSize=function(){var t=window,e=document,n=e.documentElement,i=e.getElementsByTagName("body")[0];return{width:t.innerWidth||n.clientWidth||i.clientWidth,height:t.innerHeight||n.clientHeight||i.clientHeight}},v.prototype.setAdHeight=function(t,e){if(void 0!==t){var n=this.elem.adContainer,i=this.elem.adContent,a=i.firstChild;this.elem.docBody;n.style.height="auto",i.style.clip="",n.style.position="absolute",n.style.left=0,n.style.top=0,t===this.data.docHeight&&1!=e||(n.style.height=t+"px",i.style.height=t+"px",a.style.height=t+"px",this.data.docHeight=t)}},v.prototype.setAdToFillContainer=function(){var t=this.elem.adContainer,e=this.elem.adContent,n=e.firstChild;this.elem.docBody;t.style.width="100%",e.style.width="100%",n.style.width="100%",n.width="100%"},l.adtechCallbackInstances=l.adtechCallbackInstances||[];var p=l.adtechCallbackInstances.length;l.adtechCallbackInstances[p]=new l.com.adtech.AdtechCustomAd$AD_ID$,l.adtechAdCallbacks=l.adtechAdCallbacks||{},l.adtechAdCallbacks[t.adServerVars.uid]=l.adtechAdCallbacks[t.adServerVars.uid]||[],l.adtechAdCallbacks[t.adServerVars.uid].push(l.adtechCallbackInstances[p])}(adtechAdConfig);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbUFkLndyYXBwZXIuanMiXSwibmFtZXMiOlsiYWRDb25maWciLCJwcmV2aWV3IiwiYXNzZXRDb250YWluZXJzIiwibWFpbiIsImlzRXhwYW5kYWJsZSIsInBhcmVudENoZWNrIiwid2luZG93IiwiZnJhbWVFbGVtZW50IiwidGFyZ2V0V2luIiwicGFyZW50Tm9kZSIsImZpcnN0Q2hpbGQiLCJjb250ZW50V2luZG93Iiwib3ZlcnJpZGVzIiwiZGlzcGxheVdpbmRvd1RhcmdldCIsImUiLCJjb25zb2xlIiwid2FybiIsInJlcXVpcmVzQnJlYWtvdXQiLCJzZWxmIiwiaWQiLCJoYXNPd25Qcm9wZXJ0eSIsImNvbnRhaW5lciIsInR5cGUiLCJhZHRlY2hJZnJhbWVIYXNoQXJyYXkiLCJ0b3AiLCJwYXJlbnQiLCJjYWxjdWxhdGVkVGFyZ2V0IiwiY3VycmVudFdpbmRvdyIsInVuZGVmaW5lZCIsInRhcmdldERvYyIsImRvY3VtZW50IiwidGFyZ2V0SXNGcmllbmRseSIsInRhcmdldFdpbmRvdyIsImNvbSIsImFkdGVjaCIsIkFkdGVjaEN1c3RvbUFkJEFEX0lEJCIsImN1c3RvbUFkIiwicHJvdG90eXBlIiwiZWxlbSIsInRvcFdpbiIsInRvb2xzIiwiZXZlbnRzIiwidHJpZ2dlckV2ZW50IiwiZWwiLCJldmVudE5hbWUiLCJldmVudCIsImNyZWF0ZUV2ZW50IiwiaW5pdEV2ZW50IiwiY3JlYXRlRXZlbnRPYmplY3QiLCJldmVudFR5cGUiLCJkaXNwYXRjaEV2ZW50IiwiZmlyZUV2ZW50IiwiaHRtbEV2ZW50cyIsImFkZEV2ZW50IiwiaGFuZGxlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJhdHRhY2hFdmVudCIsInJlbW92ZUV2ZW50IiwicmVtb3ZldmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImRldGFjaEV2ZW50IiwibWFzayIsInZhbCIsImdldFBlcmNlbnRhZ2UiLCJudW0iLCJwZXJjZW50YWdlIiwiZ2V0U2l6ZVN0eWxlIiwic2l6ZSIsInByb2Nlc3NlZCIsInRoaXMiLCJwYXJzZUludCIsInNwbGl0IiwiZGF0YSIsImlzTmFOIiwicGFyc2VGbG9hdCIsIk1hdGgiLCJyb3VuZCIsImdldFZpZXdwb3J0U2l6ZSIsInciLCJpbm5lcldpZHRoIiwiaCIsImlubmVySGVpZ2h0IiwiZCIsImNvbXBhdE1vZGUiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImJvZHkiLCJkZWNsYXJlRXZlbnRzIiwiYWR2ZXJ0IiwiQURURUNIIiwicHJlSW5pdCIsImluaXQiLCJhZENvbnRhaW5lciIsImFuY2hvckRpdiIsImFkQ29udGVudCIsImFkSWZyYW1lIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJhZEJvZHkiLCJsaWIiLCJ1dGlscyIsIlV0aWxzXyRWRVJTSU9OJCIsImdsb2JhbEV2ZW50QnVzIiwiYWR0ZWNoQWRNYW5hZ2VyXyRWRVJTSU9OJCIsInJpY2hNZWRpYUV2ZW50IiwiUmljaE1lZGlhRXZlbnRfJFZFUlNJT04kIiwibWV0YURhdGEiLCJyZWNpZXZlTWV0YSIsInRvcFBvc2l0aW9uIiwic2Nyb2xsVG9wIiwid2luV2lkdGgiLCJ3aW5IZWlnaHQiLCJkb2NIZWlnaHQiLCJ3aGVuUmVhZHkiLCJoYW5kbGVQYXJlbnREYXRhIiwic2VuZE1ldGEiLCJzZXR1cFNjcm9sbERhdGEiLCJnZXRBZFdyYXBwZXJQb3NpdGlvbiIsInNldEFkSGVpZ2h0Iiwic2V0dXBSZXNpemUiLCJtZXRhIiwiZXZlbnRCdXMiLCJzZXRJbnRlcnZhbCIsInNldEFkVG9GaWxsQ29udGFpbmVyIiwiZWxlbWVudCIsImJvZHlSZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiZWxlbVJlY3QiLCJnZXRTY3JvbGxUb3AiLCJkb2MiLCJwYWdlWU9mZnNldCIsImNsaWVudFRvcCIsIndoZWVsIiwiRGF0ZSIsImdldFRpbWUiLCJ3aW5TaXplIiwiZ2V0V2luZG93U2l6ZSIsIndpZHRoIiwiaGVpZ2h0IiwiZyIsImZvcmNlIiwidG9wV3JhcHBlciIsImNvbnRlbnRXcmFwcGVyIiwiaWZyYW1lIiwiZG9jQm9keSIsInN0eWxlIiwiY2xpcCIsInBvc2l0aW9uIiwibGVmdCIsImFkdGVjaENhbGxiYWNrSW5zdGFuY2VzIiwiaW5zdGFuY2VJbmRleCIsImxlbmd0aCIsImFkdGVjaEFkQ2FsbGJhY2tzIiwiYWRTZXJ2ZXJWYXJzIiwidWlkIiwicHVzaCIsImFkdGVjaEFkQ29uZmlnIl0sIm1hcHBpbmdzIjoiQ0FLQSxTQUFVQSxHQU1SLElBQUtBLEVBQVNDLFFBQVMsQ0FDckJELEVBQVNFLGdCQUFnQkMsS0FBS0MsY0FBZSxDQUM3QyxLQUNFLEdBQUlDLEtBQWNDLE9BQU9DLGFBQ3JCQyxFQUFZSCxFQUFjQyxPQUFPQyxhQUFhRSxXQUFXQyxXQUFXQSxXQUFXQyxjQUFnQkwsTUFDbkdOLEdBQVNZLFVBQVlaLEVBQVNZLGNBQzlCWixFQUFTWSxVQUFVQyxvQkFBc0JMLEVBQ3pDLE1BQU1NLEdBQ05DLFFBQVFDLEtBQUssbUZBQW9GRixJQUlyRyxHQUFJRyxJQUFtQixDQUN2QixLQUFLakIsRUFBU1ksV0FBYVosRUFBU1ksVUFBVUMscUJBQXVCSyxLQUNuRSxJQUFLLEdBQUlDLEtBQU1uQixHQUFTRSxnQkFDdEIsR0FBSUYsRUFBU0UsZ0JBQWdCa0IsZUFBZUQsR0FBSyxDQUMvQyxHQUFJRSxHQUFZckIsRUFBU0UsZ0JBQWdCaUIsRUFDekMsSUFBc0IsYUFBbEJFLEVBQVVDLE1BQXVCRCxFQUFVakIsYUFBYyxDQUMzRGEsR0FBbUIsQ0FDbkIsUUFNUixHQUFJakIsRUFBU1ksV0FBYVosRUFBU1ksVUFBVUMsb0JBQXFCLENBQ2hFLEdBQUlBLEdBQXNCYixFQUFTWSxVQUFVQyxtQkFDN0NBLEdBQXVELG1CQUF6QlUsd0JBQXdDTCxNQUFRTSxJQUMxRVgsRUFBb0JZLE9BQVNaLE1BQzVCLENBR0wsSUFGQSxHQUFJYSxHQUFtQixLQUNuQkMsRUFBZ0JGLFdBQ0lHLElBQWpCRCxHQUE0QixDQUNqQyxJQUNFLEdBQUlFLEdBQVlGLEVBQWNHLFFBQzFC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QU1DLEtBQU8sR0FDNUJMLEVBQVdJLE1BQU1FLFNBQVcsV0FDNUJOLEVBQVdJLE1BQU1HLEtBQU8sRUFDeEJQLEVBQVdJLE1BQU16SCxJQUFNLEVBRW5Ca0gsSUFBU3JFLEtBQUtHLEtBQUt3QyxXQUFvQixHQUFQNEIsSUFNbENDLEVBQVdJLE1BQU1QLE9BQVNBLEVBQVMsS0FHbkNJLEVBQWVHLE1BQU1QLE9BQVNBLEVBQVMsS0FHdkNLLEVBQU9FLE1BQU1QLE9BQVNBLEVBQVMsS0FHL0JyRSxLQUFLRyxLQUFLd0MsVUFBWTBCLEtBSTFCdEcsRUFBU0MsVUFBVXNGLHFCQUF1QixXQUV4QyxHQUFJa0IsR0FBYXhFLEtBQUsvQixLQUFLdUQsWUFDdkJpRCxFQUFpQnpFLEtBQUsvQixLQUFLeUQsVUFDM0JnRCxFQUFTRCxFQUFlcEksVUFDZDJELE1BQUsvQixLQUFLMEcsT0FFeEJILEdBQVdJLE1BQU1SLE1BQVEsT0FDekJLLEVBQWVHLE1BQU1SLE1BQVEsT0FDN0JNLEVBQU9FLE1BQU1SLE1BQVEsT0FDckJNLEVBQU9OLE1BQVEsUUFHakJ6RyxFQUFhcUgsd0JBQTBCckgsRUFBYXFILDJCQUNwRCxJQUFJQyxHQUFnQnRILEVBQWFxSCx3QkFBd0JFLE1BQ3pEdkgsR0FBYXFILHdCQUF3QkMsR0FBaUIsR0FBSXRILEdBQWFDLElBQUlDLE9BQU9DLHNCQUVsRkgsRUFBYXdILGtCQUFvQnhILEVBQWF3SCxzQkFDOUN4SCxFQUFhd0gsa0JBQWtCeEosRUFBU3lKLGFBQWFDLEtBQ2pEMUgsRUFBYXdILGtCQUFrQnhKLEVBQVN5SixhQUFhQyxTQUN6RDFILEVBQWF3SCxrQkFBa0J4SixFQUFTeUosYUFBYUMsS0FBS0MsS0FDdEQzSCxFQUFhcUgsd0JBQXdCQyxLQUN4Q00iLCJmaWxlIjoiY3VzdG9tQWQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEJvaWxlcnBsYXRlIGNvZGUgcmVxdWlyZWQgdG8gaG9vayBpbnRvIHRoZSBBRFRFQ0ggcmljaCBtZWRpYSBsaWJyYXJ5LlxuICpcbiAqIEZvciBBUEkgZG9jdW1lbnRhdGlvbiwgcGxlYXNlIGNvbnRhY3QgY2FudmFzLWhlbHBAYWR0ZWNoLmNvbVxuICovXG4oZnVuY3Rpb24oYWRDb25maWcpIHtcblxuICAvKlxuICAgKiBWaWRpYmxlIGNoZWNrXG4gICAqIFRoaXMgYXNzaWducyB0aGUgdmlkaWJsZSBwYXJlbnQgd2luZG93IGFzIHRoZSB0YXJnZXQgd2luZG93XG4gICAqL1xuICBpZiAoIWFkQ29uZmlnLnByZXZpZXcpIHtcbiAgICBhZENvbmZpZy5hc3NldENvbnRhaW5lcnMubWFpbi5pc0V4cGFuZGFibGUgPSB0cnVlO1xuICAgIHRyeSB7XG4gICAgICB2YXIgcGFyZW50Q2hlY2sgPSB3aW5kb3cuZnJhbWVFbGVtZW50ID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgdmFyIHRhcmdldFdpbiA9IHBhcmVudENoZWNrID8gd2luZG93LmZyYW1lRWxlbWVudC5wYXJlbnROb2RlLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC5jb250ZW50V2luZG93IDogd2luZG93O1xuICAgICAgYWRDb25maWcub3ZlcnJpZGVzID0gYWRDb25maWcub3ZlcnJpZGVzIHx8IHt9O1xuICAgICAgYWRDb25maWcub3ZlcnJpZGVzLmRpc3BsYXlXaW5kb3dUYXJnZXQgPSB0YXJnZXRXaW47XG4gICAgfSBjYXRjaChlKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBmaW5kIHRhcmdldCBpZnJhbWUgaW4gcGxheWVyIGVudmlyb25tZW50OiBIYXMgdGhlIHN0cnVjdHVyZSBjaGFuZ2VkP1xcbicsIGUpO1xuICAgIH1cbiAgfVxuICBcbiAgdmFyIHJlcXVpcmVzQnJlYWtvdXQgPSBmYWxzZTtcbiAgaWYgKCFhZENvbmZpZy5vdmVycmlkZXMgfHwgYWRDb25maWcub3ZlcnJpZGVzLmRpc3BsYXlXaW5kb3dUYXJnZXQgIT0gc2VsZikge1xuICAgIGZvciAodmFyIGlkIGluIGFkQ29uZmlnLmFzc2V0Q29udGFpbmVycykge1xuICAgICAgaWYgKGFkQ29uZmlnLmFzc2V0Q29udGFpbmVycy5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9IGFkQ29uZmlnLmFzc2V0Q29udGFpbmVyc1tpZF07XG4gICAgICAgIGlmIChjb250YWluZXIudHlwZSAhPSAnaW5saW5lRGl2JyB8fCBjb250YWluZXIuaXNFeHBhbmRhYmxlKSB7XG4gICAgICAgICAgcmVxdWlyZXNCcmVha291dCA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoYWRDb25maWcub3ZlcnJpZGVzICYmIGFkQ29uZmlnLm92ZXJyaWRlcy5kaXNwbGF5V2luZG93VGFyZ2V0KSB7XG4gICAgdmFyIGRpc3BsYXlXaW5kb3dUYXJnZXQgPSBhZENvbmZpZy5vdmVycmlkZXMuZGlzcGxheVdpbmRvd1RhcmdldDtcbiAgICBkaXNwbGF5V2luZG93VGFyZ2V0ID0gKHR5cGVvZiBhZHRlY2hJZnJhbWVIYXNoQXJyYXkgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZiAhPSB0b3ApID9cbiAgICAgICAgZGlzcGxheVdpbmRvd1RhcmdldC5wYXJlbnQgOiBkaXNwbGF5V2luZG93VGFyZ2V0O1xuICB9IGVsc2Uge1xuICAgIHZhciBjYWxjdWxhdGVkVGFyZ2V0ID0gbnVsbDtcbiAgICB2YXIgY3VycmVudFdpbmRvdyA9IHBhcmVudDtcbiAgICB3aGlsZSAoY3VycmVudFdpbmRvdyAhPSB1bmRlZmluZWQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciB0YXJnZXREb2MgPSBjdXJyZW50V2luZG93LmRvY3VtZW50O1xuICAgICAgICBpZiAodGFyZ2V0RG9jKSB7XG4gICAgICAgICAgY2FsY3VsYXRlZFRhcmdldCA9IGN1cnJlbnRXaW5kb3c7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2goZSkge31cbiAgICAgIGN1cnJlbnRXaW5kb3cgPSAoY3VycmVudFdpbmRvdyA9PSB0b3ApID8gbnVsbCA6IGN1cnJlbnRXaW5kb3cucGFyZW50O1xuICAgIH1cbiAgICB2YXIgZGlzcGxheVdpbmRvd1RhcmdldCA9IGNhbGN1bGF0ZWRUYXJnZXQgfHwgdG9wO1xuICB9XG5cbiAgdmFyIHRhcmdldElzRnJpZW5kbHkgPSBmYWxzZTtcbiAgdHJ5IHtcbiAgICB2YXIgdGFyZ2V0RG9jID0gZGlzcGxheVdpbmRvd1RhcmdldC5kb2N1bWVudDtcbiAgICBpZiAodGFyZ2V0RG9jKSB7XG4gICAgICB0YXJnZXRJc0ZyaWVuZGx5ID0gdHJ1ZTtcbiAgICB9XG4gIH0gY2F0Y2goZSkge31cblxuICB2YXIgdGFyZ2V0V2luZG93ID0gKHJlcXVpcmVzQnJlYWtvdXQgJiYgKHNlbGYgIT0gdG9wICYmIHRhcmdldElzRnJpZW5kbHkpKSA/XG4gICAgICAgICAgZGlzcGxheVdpbmRvd1RhcmdldCA6IHNlbGY7XG4gIFxuICB0YXJnZXRXaW5kb3cuY29tID0gdGFyZ2V0V2luZG93LmNvbSB8fCB7fTtcbiAgdGFyZ2V0V2luZG93LmNvbS5hZHRlY2ggPSB0YXJnZXRXaW5kb3cuY29tLmFkdGVjaCB8fCB7fTtcblxuICAvKlxuICAgKiBDdXN0b21BZC5qcyBDb25zdHJ1Y3RvclxuICAgKi9cbiAgdGFyZ2V0V2luZG93LmNvbS5hZHRlY2guQWR0ZWNoQ3VzdG9tQWQkQURfSUQkID0gZnVuY3Rpb24oKSB7fTtcbiAgXG4gIC8qXG4gICAqIEluY2x1ZGUgcGFydGlhbHNcbiAgICovXG4gIC8vIENvcmUgY2xhc3NcbiAgLyoqXG4gICAqIEN1c3RvbUFkLmpzIFByb3RvdHlwZSAtIGF0dGFjaGVkIHRvIEN1c3RvbUFkIHByb3RvdHlwZVxuICAgKi9cbiAgdmFyIGN1c3RvbUFkID0gdGFyZ2V0V2luZG93LmNvbS5hZHRlY2guQWR0ZWNoQ3VzdG9tQWQkQURfSUQkO1xuICBcbiAgLy8gQWRkIHdpbmRvdyBvYmplY3RzIHRvIGVsZW1lbnRzIHByb3BlcnR5XG4gIGN1c3RvbUFkLnByb3RvdHlwZS5lbGVtID0ge307XG4gIGN1c3RvbUFkLnByb3RvdHlwZS5lbGVtLnRvcFdpbiA9IHdpbmRvdy5wYXJlbnQ7XG4gIGN1c3RvbUFkLnByb3RvdHlwZS5lbGVtLnRhcmdldFdpbmRvdyA9IHRhcmdldFdpbmRvdztcbiAgXG4gIC8vIFRvb2xraXRcbiAgLyoqXG4gICAqIEN1c3RvbSBBZCBUb29sc1xuICAgKi9cbiAgY3VzdG9tQWQucHJvdG90eXBlLnRvb2xzID0ge1xuICAgIGV2ZW50cyA6IHtcbiAgICAgIHRyaWdnZXJFdmVudCA6IGZ1bmN0aW9uKGVsLCBldmVudE5hbWUpe1xuICAgICAgICB2YXIgZXZlbnQ7XG4gICAgICAgIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudCkge1xuICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcbiAgICAgICAgICBldmVudC5pbml0RXZlbnQoZXZlbnROYW1lLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCkgey8vIElFIDwgOVxuICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTtcbiAgICAgICAgICBldmVudC5ldmVudFR5cGUgPSBldmVudE5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQuZXZlbnROYW1lID0gZXZlbnROYW1lO1xuICAgICAgICBpZiAoZWwuZGlzcGF0Y2hFdmVudCkge1xuICAgICAgICAgIGVsLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKGVsLmZpcmVFdmVudCAmJiBodG1sRXZlbnRzWydvbicrZXZlbnROYW1lXSkgey8vIElFIDwgOVxuICAgICAgICAgIGVsLmZpcmVFdmVudCgnb24nK2V2ZW50LmV2ZW50VHlwZSxldmVudCk7Ly8gY2FuIHRyaWdnZXIgb25seSByZWFsIGV2ZW50IChlLmcuICdjbGljaycpXG4gICAgICAgIH0gZWxzZSBpZiAoZWxbZXZlbnROYW1lXSl7XG4gICAgICAgICAgZWxbZXZlbnROYW1lXSgpO1xuICAgICAgICB9IGVsc2UgaWYgKGVsWydvbicrZXZlbnROYW1lXSkge1xuICAgICAgICAgIGVsWydvbicrZXZlbnROYW1lXSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYWRkRXZlbnQgOiBmdW5jdGlvbihlbCwgdHlwZSwgaGFuZGxlcil7XG4gICAgICAgIGlmIChlbC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLGhhbmRsZXIsZmFsc2UpO1xuICAgICAgICB9IGVsc2UgaWYgKGVsLmF0dGFjaEV2ZW50ICYmIGh0bWxFdmVudHNbJ29uJyt0eXBlXSl7Ly8gSUUgPCA5XG4gICAgICAgICAgZWwuYXR0YWNoRXZlbnQoJ29uJyt0eXBlLGhhbmRsZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsWydvbicrdHlwZV09aGFuZGxlcjtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlbW92ZUV2ZW50IDogZnVuY3Rpb24oZWwsIHR5cGUsIGhhbmRsZXIpe1xuICAgICAgICBpZihlbC5yZW1vdmV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsaGFuZGxlcixmYWxzZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZWwuZGV0YWNoRXZlbnQgJiYgaHRtbEV2ZW50c1snb24nK3R5cGVdKXsvLyBJRSA8IDlcbiAgICAgICAgICBlbC5kZXRhY2hFdmVudCgnb24nK3R5cGUsaGFuZGxlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWxbJ29uJyt0eXBlXT1udWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBtYXNrIDogZnVuY3Rpb24oZWxlbSwgdmFsKSB7XG4gICAgICAvLyBlbGVtLnN0eWxlLmNsaXAgPSAncmVjdCgnK3ZhbCsnKSc7XG4gICAgfSxcbiAgICBnZXRQZXJjZW50YWdlIDogZnVuY3Rpb24obnVtLCBwZXJjZW50YWdlKSB7XG4gICAgICByZXR1cm4gKG51bSAvIDEwMCkgKiBwZXJjZW50YWdlO1xuICAgIH0sXG4gICAgLypcbiAgICAgKiBSZXR1cm4gcGl4ZWwgKyBwZXJjZW50IHZhbHVlcyBmcm9tIGludGVnZXIgLyBzdHJpbmcgLCBlZyAnMTAlJ1xuICAgICAqL1xuICAgIGdldFNpemVTdHlsZSA6IGZ1bmN0aW9uKHZhbCwgc2l6ZSkge1xuICAgICAgLy8gY29uc29sZS5sb2codmFsLCBzaXplKVxuICAgICAgdmFyIHRvb2xzID0gdGhpcy50b29scztcbiAgICAgIHZhciBwcm9jZXNzZWQgPSB7fTtcbiAgICAgIHZhciBudW0gPSBwYXJzZUludCh2YWwsIDEwKTtcbiAgICAgIHZhciB2YWwgPSB2YWwuc3BsaXQobnVtKVsxXTtcbiAgICAgIGRhdGEgPSB7XG4gICAgICAgIG51bSA6IChpc05hTihwYXJzZUZsb2F0KChudW0pKSkgPyAwIDogbnVtKSxcbiAgICAgICAgdmFsIDogKHR5cGVvZiB2YWwhPT0ndW5kZWZpbmVkJyA/IHZhbCA6ICdweCcpXG4gICAgICB9XG4gICAgICBpZiAoZGF0YS52YWw9PSclJykge1xuICAgICAgICBwcm9jZXNzZWRbJ3B4J10gPSBNYXRoLnJvdW5kKChzaXplIC8gMTAwKSAqIGRhdGEubnVtKTtcbiAgICAgICAgcHJvY2Vzc2VkWydwZXJjZW50J10gPSBkYXRhLm51bTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2Nlc3NlZFsncHgnXSA9IGRhdGEubnVtO1xuICAgICAgICBwcm9jZXNzZWRbJ3BlcmNlbnQnXSA9IGRhdGEubnVtIC8gc2l6ZSAqIDEwMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwcm9jZXNzZWQ7XG4gICAgfSxcbiAgICBnZXRWaWV3cG9ydFNpemUgOiBmdW5jdGlvbih3KSB7XG4gICAgICAvLyBVc2UgdGhlIHNwZWNpZmllZCB3aW5kb3cgb3IgdGhlIGN1cnJlbnQgd2luZG93IGlmIG5vIGFyZ3VtZW50XG4gICAgICB3ID0gdyB8fCB3aW5kb3c7XG4gIFxuICAgICAgLy8gVGhpcyB3b3JrcyBmb3IgYWxsIGJyb3dzZXJzIGV4Y2VwdCBJRTggYW5kIGJlZm9yZVxuICAgICAgaWYgKHcuaW5uZXJXaWR0aCAhPSBudWxsKSByZXR1cm4geyB3OiB3LmlubmVyV2lkdGgsIGg6IHcuaW5uZXJIZWlnaHQgfTtcbiAgXG4gICAgICAvLyBGb3IgSUUgKG9yIGFueSBicm93c2VyKSBpbiBTdGFuZGFyZHMgbW9kZVxuICAgICAgdmFyIGQgPSB3LmRvY3VtZW50O1xuICAgICAgaWYgKGRvY3VtZW50LmNvbXBhdE1vZGUgPT0gXCJDU1MxQ29tcGF0XCIpXG4gICAgICAgICAgcmV0dXJuIHsgdzogZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICAgaDogZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IH07XG4gIFxuICAgICAgLy8gRm9yIGJyb3dzZXJzIGluIFF1aXJrcyBtb2RlXG4gICAgICByZXR1cm4geyB3OiBkLmJvZHkuY2xpZW50V2lkdGgsIGg6IGQuYm9keS5jbGllbnRIZWlnaHQgfTtcbiAgICB9XG4gIH07XG4gIFxuICAvKipcbiAgICogRXZlbnRzIGxpc3RcbiAgICogVGhpcyBtZXRob2QgaXMgbmV2ZXIgdXNlZCwgb25seSBoZXJlIGZvciBPTkUgdG8gcGFyc2VcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5kZWNsYXJlRXZlbnRzID0gZnVuY3Rpb24oYWR2ZXJ0KSB7XG4gICAgXG4gICAgLy8gUGFyZW50IGV2ZW50c1xuICAgIEFEVEVDSC5ldmVudCgnUllPVF9QQVJFTlRfTUVUQScpO1xuICAgIEFEVEVDSC5ldmVudCgnUllPVF9SRVNJWkUnKTtcbiAgICBBRFRFQ0guZXZlbnQoJ1JZT1RfRklMTFdJRFRIJyk7XG4gIFxuICAgIC8vIENoaWxkIGV2ZW50c1xuICAgIEFEVEVDSC5ldmVudCgnUllPVF9DSElMRF9NRVRBJyk7XG4gICAgQURURUNILmV2ZW50KCdSWU9UX0NISUxEX1JFU0laRScpO1xuICBcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBwcmVJbml0IE1ldGhvZFxuICAgKi9cbiAgY3VzdG9tQWQucHJvdG90eXBlLnByZUluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAod2luZG93PT1udWxsKSByZXR1cm47XG4gICAgd2luZG93LmNvbSA9IGNvbSB8fCB7fTtcbiAgICBjb20uYWR0ZWNoID0gd2luZG93LmNvbS5hZHRlY2g7XG4gIH07XG4gIFxuICAvKipcbiAgICogSW5pdCBjdXN0b21BZFxuICAgKi9cbiAgY3VzdG9tQWQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihhZHZlcnQpIHtcbiAgICBcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gIFxuICAgIC8vIEFEVEVDSCBhZHZlcnQgZGF0YSBvYmplY3RcbiAgICB0aGlzLmFkdmVydCA9IGFkdmVydDtcbiAgXG4gICAgLy8gRWxlbWVudHNcbiAgICB0aGlzLmVsZW0uYWRDb250YWluZXIgPSBhZHZlcnQuYXNzZXRDb250YWluZXJzLm1haW4uYW5jaG9yRGl2O1xuICAgIHRoaXMuZWxlbS5hZENvbnRlbnQgPSBhZHZlcnQuYXNzZXRDb250YWluZXJzLm1haW4uYW5jaG9yRGl2LmZpcnN0Q2hpbGQ7XG4gICAgdGhpcy5lbGVtLmFkSWZyYW1lID0gdGhpcy5lbGVtLmFkQ29udGVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaWZyYW1lJylbMF07XG4gICAgdGhpcy5lbGVtLmFkQm9keSA9IGRvY3VtZW50IHx8IHRoaXMuZWxlbS5hZElmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50O1xuICBcbiAgICAvLyBBRFRFQ0ggbGlicmFyaWVzXG4gICAgdGhpcy5saWIgPSB7fTtcbiAgICB0aGlzLmxpYi51dGlscyA9IHRhcmdldFdpbmRvdy5jb20uYWR0ZWNoLlV0aWxzXyRWRVJTSU9OJDtcbiAgICB0aGlzLmxpYi5nbG9iYWxFdmVudEJ1cyA9IHRhcmdldFdpbmRvdy5hZHRlY2hBZE1hbmFnZXJfJFZFUlNJT04kLmdsb2JhbEV2ZW50QnVzO1xuICAgIHRoaXMubGliLnJpY2hNZWRpYUV2ZW50ID0gdGFyZ2V0V2luZG93LmNvbS5hZHRlY2guUmljaE1lZGlhRXZlbnRfJFZFUlNJT04kO1xuICBcbiAgICAvLyBNZXRhIGRhdGEgdG8gcGFzcyB0byBjaGlsZFxuICAgIHRoaXMubWV0YURhdGEgPSB7fTtcbiAgXG4gICAgLy8gU2V0dXAgcmVjaWV2ZXJcbiAgICB0aGlzLnJlY2lldmVNZXRhKCk7ICBcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBQYXJlbnQgZGF0YSBvYmplY3RcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5kYXRhID0ge1xuICAgIHRvcFBvc2l0aW9uIDogMCxcbiAgICBzY3JvbGxUb3AgOiAwLFxuICAgIHdpbldpZHRoIDogMCxcbiAgICB3aW5IZWlnaHQgOiAwLFxuICAgIGRvY0hlaWdodCA6IDBcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBDaGlsZCBkYXRhXG4gICAqL1xuICAvLyBjdXN0b21BZC5wcm90b3R5cGUuY2hpbGREYXRhID0ge31cbiAgXG4gIC8qKlxuICAgKiBGaXJlIHRoaXMgc3R1ZmYgd2hlbiByZWFkeSAoY2hpbGQgbWV0YSBpcyByZWNpZXZlZClcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS53aGVuUmVhZHkgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBQcm9jZXNzIGRhdGEgZnJvbSBwYXJlbnRcbiAgICB0aGlzLmhhbmRsZVBhcmVudERhdGEoKTtcbiAgICAvLyBTZXR1cCBkaXNwYXRjaGVyXG4gICAgdGhpcy5zZW5kTWV0YSgpO1xuICB9O1xuICBcbiAgLyoqXG4gICAqIEhhbmRsZSBQYXJlbnQgZGF0YVxuICAgKi9cbiAgY3VzdG9tQWQucHJvdG90eXBlLmhhbmRsZVBhcmVudERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBTY3JvbGwgcG9zaXRpb25cbiAgICB0aGlzLnNldHVwU2Nyb2xsRGF0YSgpO1xuICAgIC8vIEdldCBBZCB3cmFwcGVyIHBvc2l0aW9uIGRhdGFcbiAgICB0aGlzLmdldEFkV3JhcHBlclBvc2l0aW9uKCk7XG4gICAgLy8gU2V0IGFkdmVydCB3cmFwcGVyIGhlaWdodFxuICAgIHRoaXMuc2V0QWRIZWlnaHQoKTtcbiAgICAvLyBTZXR1cCByZXNpemUgZXZlbnRcbiAgICB0aGlzLnNldHVwUmVzaXplKCk7XG4gIH07XG4gIFxuICAvKipcbiAgICogRGlzcGF0Y2ggZXZlbnQgdG8gY2hpbGRcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24oZXZlbnROYW1lLCBkYXRhKSB7XG4gICAgdmFyIHJpY2hNZWRpYUV2ZW50ID0gbmV3IHRoaXMubGliLnJpY2hNZWRpYUV2ZW50KGV2ZW50TmFtZSk7XG4gICAgdmFyIGRhdGEgPSBkYXRhIHx8IHt9O1xuICAgIHJpY2hNZWRpYUV2ZW50Lm1ldGEgPSBkYXRhO1xuICAgIHRoaXMuYWR2ZXJ0LmV2ZW50QnVzLmRpc3BhdGNoRXZlbnQocmljaE1lZGlhRXZlbnQpO1xuICB9O1xuICBcbiAgLyoqXG4gICAqIFNlbmQgbWV0YSBkYXRhIHRvIGNoaWxkIChhZHZlcnQpXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUuc2VuZE1ldGEgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ1JZT1RfUEFSRU5UX01FVEEnLCBzZWxmLmRhdGEpO1xuICAgIH0sIDEwMCk7XG4gIH07XG4gIFxuICAvKipcbiAgICogUmVjaWV2ZSBtZXRhIGRhdGEgZnJvbSBjaGlsZFxuICAgKi9cbiAgY3VzdG9tQWQucHJvdG90eXBlLnJlY2lldmVNZXRhID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIC8vIE1ldGEgZGF0YVxuICAgIHRoaXMuYWR2ZXJ0LmV2ZW50QnVzLmFkZEV2ZW50TGlzdGVuZXIoJ1JZT1RfQ0hJTERfTUVUQScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHNlbGYuZGF0YS5kb2NIZWlnaHQgPSBlLm1ldGEuZG9jSGVpZ2h0O1xuICAgICAgLy8gU2V0IGFkdmVydCB3cmFwcGVyIGhlaWdodFxuICAgICAgc2VsZi5zZXRBZEhlaWdodChlLm1ldGEuZG9jSGVpZ2h0LCB0cnVlKTtcbiAgICAgIC8vIE1ldGEgaXMgcmVhZHksIHNvIGZpcmVcbiAgICAgIHNlbGYud2hlblJlYWR5KCk7XG4gICAgfSk7XG4gICAgLy8gQ2hlY2sgaWYgd3JhcHBlciBzaG91bGQgZmlsbCBjb250YWluZXJcbiAgICB0aGlzLmFkdmVydC5ldmVudEJ1cy5hZGRFdmVudExpc3RlbmVyKCdSWU9UX0ZJTExXSURUSCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHNlbGYuc2V0QWRUb0ZpbGxDb250YWluZXIoKTtcbiAgICAgIHNlbGYuc2V0QWRIZWlnaHQoc2VsZi5kYXRhLmRvY0hlaWdodCk7XG4gICAgfSk7XG4gIH07XG4gIFxuICAvKipcbiAgICogXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUuZ2V0QWRXcmFwcGVyUG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbS5hZENvbnRhaW5lcjtcbiAgICB2YXIgYm9keVJlY3QgPSBkb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICBlbGVtUmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgIHRvcCA9IGVsZW1SZWN0LnRvcCAtIGJvZHlSZWN0LnRvcDtcbiAgICB0aGlzLmRhdGEudG9wUG9zaXRpb24gPSB0b3A7XG4gIH0sXG4gIFxuICAvKipcbiAgICogXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUuc2V0dXBTY3JvbGxEYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAnc2Nyb2xsJywgd2hlZWwsIGZhbHNlICk7XG4gICAgZnVuY3Rpb24gZ2V0U2Nyb2xsVG9wKCkge1xuICAgICAgdmFyIGRvYyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgICAgIHZhciB0b3AgPSAod2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvYy5zY3JvbGxUb3ApICAtIChkb2MuY2xpZW50VG9wIHx8IDApO1xuICAgICAgcmV0dXJuIHRvcDtcbiAgICB9XG4gICAgdmFyIGxhc3RPZmZzZXQgPSBnZXRTY3JvbGxUb3AoKTtcbiAgICB2YXIgbGFzdERhdGUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICBmdW5jdGlvbiB3aGVlbChlKSB7XG4gICAgICBzZWxmLmRhdGEuc2Nyb2xsVG9wID0gZ2V0U2Nyb2xsVG9wKCk7XG4gICAgfVxuICAgIHRoaXMuZGF0YS5zY3JvbGxUb3AgPSBnZXRTY3JvbGxUb3AoKTtcbiAgfVxuICBcbiAgY3VzdG9tQWQucHJvdG90eXBlLnNldHVwUmVzaXplID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB3aW5TaXplID0gc2VsZi5nZXRXaW5kb3dTaXplKCk7XG4gICAgc2VsZi5kYXRhLndpbldpZHRoID0gd2luU2l6ZS53aWR0aDtcbiAgICBzZWxmLmRhdGEud2luSGVpZ2h0ID0gd2luU2l6ZS5oZWlnaHQ7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uKCl7XG4gICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ1JZT1RfUkVTSVpFJywgc2VsZi5kYXRhKTtcbiAgICB9LCB0cnVlKTtcbiAgICAvLyBSZWNpZXZlIGRhdGFcbiAgICB0aGlzLmFkdmVydC5ldmVudEJ1cy5hZGRFdmVudExpc3RlbmVyKCdSWU9UX0NISUxEX1JFU0laRScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciB3aW5TaXplID0gc2VsZi5nZXRXaW5kb3dTaXplKCk7XG4gICAgICBzZWxmLmRhdGEud2luV2lkdGggPSB3aW5TaXplLndpZHRoO1xuICAgICAgc2VsZi5kYXRhLndpbkhlaWdodCA9IHdpblNpemUuaGVpZ2h0O1xuICAgICAgc2VsZi5zZXRBZEhlaWdodChlLm1ldGEuZG9jSGVpZ2h0KTtcbiAgICB9KTtcbiAgfTtcbiAgXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5nZXRXaW5kb3dTaXplID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHcgPSB3aW5kb3csXG4gICAgICAgIGQgPSBkb2N1bWVudCxcbiAgICAgICAgZSA9IGQuZG9jdW1lbnRFbGVtZW50LFxuICAgICAgICBnID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdLFxuICAgICAgICB4ID0gdy5pbm5lcldpZHRoIHx8IGUuY2xpZW50V2lkdGggfHwgZy5jbGllbnRXaWR0aCxcbiAgICAgICAgeSA9IHcuaW5uZXJIZWlnaHR8fCBlLmNsaWVudEhlaWdodHx8IGcuY2xpZW50SGVpZ2h0O1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aCA6IHgsXG4gICAgICBoZWlnaHQgOiB5XG4gICAgfTtcbiAgfTtcbiAgXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5zZXRBZEhlaWdodCA9IGZ1bmN0aW9uKGhlaWdodCwgZm9yY2UpIHtcbiAgICBcbiAgICBpZiAodHlwZW9mIGhlaWdodCA9PSAndW5kZWZpbmVkJykgcmV0dXJuO1xuICAgIHZhciB0b3BXcmFwcGVyID0gdGhpcy5lbGVtLmFkQ29udGFpbmVyO1xuICAgIHZhciBjb250ZW50V3JhcHBlciA9IHRoaXMuZWxlbS5hZENvbnRlbnQ7XG4gICAgdmFyIGlmcmFtZSA9IGNvbnRlbnRXcmFwcGVyLmZpcnN0Q2hpbGQ7XG4gICAgdmFyIGRvY0JvZHkgPSB0aGlzLmVsZW0uZG9jQm9keTtcbiAgXG4gICAgLy8gVG9wIHdyYXBwZXJcbiAgICAvLyB0b3BXcmFwcGVyLnN0eWxlLndpZHRoID0gXCJhdXRvXCI7XG4gICAgdG9wV3JhcHBlci5zdHlsZS5oZWlnaHQgPSBcImF1dG9cIjtcbiAgXG4gICAgLy8gU3R5bGVcbiAgICBjb250ZW50V3JhcHBlci5zdHlsZS5jbGlwID0gXCJcIjtcbiAgICB0b3BXcmFwcGVyLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgIHRvcFdyYXBwZXIuc3R5bGUubGVmdCA9IDA7XG4gICAgdG9wV3JhcHBlci5zdHlsZS50b3AgPSAwO1xuICBcbiAgICBpZiAoaGVpZ2h0IT09dGhpcy5kYXRhLmRvY0hlaWdodCB8fCBmb3JjZT09dHJ1ZSkge1xuICBcbiAgICAgIC8vIHRoaXMuZGF0YS5kb2NIZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAvLyBoZWlnaHQgPSB0aGlzLmRhdGEuZG9jSGVpZ2h0O1xuICBcbiAgICAgIC8vIHRvcFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gMCArIFwicHhcIjtcbiAgICAgIHRvcFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgXCJweFwiO1xuICAgICAgLy8gXG4gICAgICAvLyBjb250ZW50V3JhcHBlci5zdHlsZS5oZWlnaHQgPSAwICsgXCJweFwiO1xuICAgICAgY29udGVudFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgXCJweFwiO1xuICAgICAgLy8gXG4gICAgICAvLyBpZnJhbWUuc3R5bGUuaGVpZ2h0ID0gMCArIFwicHhcIjtcbiAgICAgIGlmcmFtZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyBcInB4XCI7XG4gIFxuICAgICAgLy8gRmluYWxpc2VcbiAgICAgIHRoaXMuZGF0YS5kb2NIZWlnaHQgPSBoZWlnaHQ7XG4gICAgfVxuICB9O1xuICBcbiAgY3VzdG9tQWQucHJvdG90eXBlLnNldEFkVG9GaWxsQ29udGFpbmVyID0gZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgdmFyIHRvcFdyYXBwZXIgPSB0aGlzLmVsZW0uYWRDb250YWluZXI7XG4gICAgdmFyIGNvbnRlbnRXcmFwcGVyID0gdGhpcy5lbGVtLmFkQ29udGVudDtcbiAgICB2YXIgaWZyYW1lID0gY29udGVudFdyYXBwZXIuZmlyc3RDaGlsZDtcbiAgICB2YXIgZG9jQm9keSA9IHRoaXMuZWxlbS5kb2NCb2R5O1xuICBcbiAgICB0b3BXcmFwcGVyLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG4gICAgY29udGVudFdyYXBwZXIuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcbiAgICBpZnJhbWUuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcbiAgICBpZnJhbWUud2lkdGggPSBcIjEwMCVcIjtcbiAgfTtcblxuICB0YXJnZXRXaW5kb3cuYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXMgPSB0YXJnZXRXaW5kb3cuYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXMgfHwgW107XG4gIHZhciBpbnN0YW5jZUluZGV4ID0gdGFyZ2V0V2luZG93LmFkdGVjaENhbGxiYWNrSW5zdGFuY2VzLmxlbmd0aDtcbiAgdGFyZ2V0V2luZG93LmFkdGVjaENhbGxiYWNrSW5zdGFuY2VzW2luc3RhbmNlSW5kZXhdID0gbmV3IHRhcmdldFdpbmRvdy5jb20uYWR0ZWNoLkFkdGVjaEN1c3RvbUFkJEFEX0lEJCgpO1xuXG4gIHRhcmdldFdpbmRvdy5hZHRlY2hBZENhbGxiYWNrcyA9IHRhcmdldFdpbmRvdy5hZHRlY2hBZENhbGxiYWNrcyB8fCB7fTtcbiAgdGFyZ2V0V2luZG93LmFkdGVjaEFkQ2FsbGJhY2tzW2FkQ29uZmlnLmFkU2VydmVyVmFycy51aWRdID1cbiAgICAgIHRhcmdldFdpbmRvdy5hZHRlY2hBZENhbGxiYWNrc1thZENvbmZpZy5hZFNlcnZlclZhcnMudWlkXSB8fCBbXTtcbiAgdGFyZ2V0V2luZG93LmFkdGVjaEFkQ2FsbGJhY2tzW2FkQ29uZmlnLmFkU2VydmVyVmFycy51aWRdLnB1c2goXG4gICAgICB0YXJnZXRXaW5kb3cuYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXNbaW5zdGFuY2VJbmRleF0pO1xufSkoYWR0ZWNoQWRDb25maWcpOyJdfQ==
