!function(t){if(!t.preview){t.assetContainers.main.isExpandable=!0;try{var e=!!window.frameElement,n=e?window.frameElement.parentNode.firstChild.firstChild.contentWindow:window;t.overrides=t.overrides||{},t.overrides.displayWindowTarget=n}catch(t){console.warn("Failed to find target iframe in player environment: Has the structure changed?\n",t)}}var i=!1;if(!t.overrides||t.overrides.displayWindowTarget!=self)for(var a in t.assetContainers)if(t.assetContainers.hasOwnProperty(a)){var o=t.assetContainers[a];if("inlineDiv"!=o.type||o.isExpandable){i=!0;break}}if(t.overrides&&t.overrides.displayWindowTarget){var d=t.overrides.displayWindowTarget;d="undefined"!=typeof adtechIframeHashArray&&self!=top?d.parent:d}else{for(var r=null,s=parent;void 0!=s;){try{var c=s.document;c&&(r=s)}catch(t){}s=s==top?null:s.parent}var d=r||top}var h=!1;try{var c=d.document;c&&(h=!0)}catch(t){}var l=i&&self!=top&&h?d:self;l.com=l.com||{},l.com.adtech=l.com.adtech||{},l.com.adtech.AdtechCustomAd$AD_ID$=function(){};var p=l.com.adtech.AdtechCustomAd$AD_ID$;p.prototype.elem={},p.prototype.elem.topWin=window.parent,p.prototype.elem.targetWindow=l,p.prototype.tools={events:{triggerEvent:function(t,e){var n;document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):document.createEventObject&&(n=document.createEventObject(),n.eventType=e),n.eventName=e,t.dispatchEvent?t.dispatchEvent(n):t.fireEvent&&htmlEvents["on"+e]?t.fireEvent("on"+n.eventType,n):t[e]?t[e]():t["on"+e]&&t["on"+e]()},addEvent:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&htmlEvents["on"+e]?t.attachEvent("on"+e,n):t["on"+e]=n},removeEvent:function(t,e,n){t.removeventListener?t.removeEventListener(e,n,!1):t.detachEvent&&htmlEvents["on"+e]?t.detachEvent("on"+e,n):t["on"+e]=null}},mask:function(t,e){},getPercentage:function(t,e){return t/100*e},getSizeStyle:function(t,e){var n=(this.tools,{}),i=parseInt(t,10),t=t.split(i)[1];return data={num:isNaN(parseFloat(i))?0:i,val:void 0!==t?t:"px"},"%"==data.val?(n.px=Math.round(e/100*data.num),n.percent=data.num):(n.px=data.num,n.percent=data.num/e*100),n},getViewportSize:function(t){if(t=t||window,null!=t.innerWidth)return{w:t.innerWidth,h:t.innerHeight};var e=t.document;return"CSS1Compat"==document.compatMode?{w:e.documentElement.clientWidth,h:e.documentElement.clientHeight}:{w:e.body.clientWidth,h:e.body.clientHeight}}},p.prototype.declareEvents=function(t){ADTECH.event("RYOT_PARENT_META"),ADTECH.event("RYOT_RESIZE"),ADTECH.event("RYOT_CHILD_META")},p.prototype.preInit=function(){null!=window&&(window.com=com||{},com.adtech=window.com.adtech)},p.prototype.init=function(t){this.advert=t,this.elem.adContainer=t.assetContainers.main.anchorDiv,this.elem.adContent=t.assetContainers.main.anchorDiv.firstChild,this.elem.adIframe=this.elem.adContent.getElementsByTagName("iframe")[0],this.elem.adBody=document||this.elem.adIframe.contentWindow.document,this.lib={},this.lib.utils=l.com.adtech.Utils_$VERSION$,this.lib.globalEventBus=l.adtechAdManager_$VERSION$.globalEventBus,this.lib.richMediaEvent=l.com.adtech.RichMediaEvent_$VERSION$,this.metaData={},this.recieveMeta()},p.prototype.data={topPosition:0,scrollTop:0,winWidth:0,winHeight:0,docHeight:0},p.prototype.whenReady=function(){this.handleParentData(),this.sendMeta()},p.prototype.handleParentData=function(){this.setupScrollData(),this.getAdWrapperPosition(),this.setAdHeight(),this.setupResize()},p.prototype.dispatchEvent=function(t,e){var n=new this.lib.richMediaEvent(t),e=e||{};n.meta=e,this.advert.eventBus.dispatchEvent(n)},p.prototype.sendMeta=function(){var t=this;setInterval(function(){t.dispatchEvent("RYOT_PARENT_META",t.data)},100)},p.prototype.recieveMeta=function(){var t=this;this.advert.eventBus.addEventListener("RYOT_CHILD_META",function(e){t.data.docHeight=e.meta.docHeight,t.setAdHeight(e.meta.docHeight),t.whenReady()})},p.prototype.getAdWrapperPosition=function(){var t=this.elem.adContainer,e=document.body.getBoundingClientRect(),n=t.getBoundingClientRect(),i=n.top-e.top;this.data.topPosition=i},p.prototype.setupScrollData=function(){function t(){var t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}function e(e){n.data.scrollTop=t()}var n=this;window.addEventListener("scroll",e,!1);t(),(new Date).getTime();this.data.scrollTop=t()},p.prototype.setupResize=function(){var t=this,e=t.getWindowSize();t.data.winWidth=e.width,t.data.winHeight=e.height,window.addEventListener("resize",function(){var e=t.getWindowSize();t.data.winWidth=e.width,t.data.winHeight=e.height,t.setAdHeight(t.data.docHeight),console.log("resize")},!0)},p.prototype.getWindowSize=function(){var t=window,e=document,n=e.documentElement,i=e.getElementsByTagName("body")[0];return{width:t.innerWidth||n.clientWidth||i.clientWidth,height:t.innerHeight||n.clientHeight||i.clientHeight}},p.prototype.setAdHeight=function(t){var e=this.elem.adContainer,n=this.elem.adContent,i=n.firstChild;this.elem.docBody;e.style.width="auto",e.style.height="auto",n.style.clip="",e.style.position="absolute",e.style.left=0,e.style.top=0,t!==this.data.docHeight&&(t=this.data.docHeight,e.style.height=t+"px",n.style.height=t+"px",i.style.height=t+"px")},l.adtechCallbackInstances=l.adtechCallbackInstances||[];var v=l.adtechCallbackInstances.length;l.adtechCallbackInstances[v]=new l.com.adtech.AdtechCustomAd$AD_ID$,l.adtechAdCallbacks=l.adtechAdCallbacks||{},l.adtechAdCallbacks[t.adServerVars.uid]=l.adtechAdCallbacks[t.adServerVars.uid]||[],l.adtechAdCallbacks[t.adServerVars.uid].push(l.adtechCallbackInstances[v])}(adtechAdConfig);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbUFkLndyYXBwZXIuanMiXSwibmFtZXMiOlsiYWRDb25maWciLCJwcmV2aWV3IiwiYXNzZXRDb250YWluZXJzIiwibWFpbiIsImlzRXhwYW5kYWJsZSIsInBhcmVudENoZWNrIiwid2luZG93IiwiZnJhbWVFbGVtZW50IiwidGFyZ2V0V2luIiwicGFyZW50Tm9kZSIsImZpcnN0Q2hpbGQiLCJjb250ZW50V2luZG93Iiwib3ZlcnJpZGVzIiwiZGlzcGxheVdpbmRvd1RhcmdldCIsImUiLCJjb25zb2xlIiwid2FybiIsInJlcXVpcmVzQnJlYWtvdXQiLCJzZWxmIiwiaWQiLCJoYXNPd25Qcm9wZXJ0eSIsImNvbnRhaW5lciIsInR5cGUiLCJhZHRlY2hJZnJhbWVIYXNoQXJyYXkiLCJ0b3AiLCJwYXJlbnQiLCJjYWxjdWxhdGVkVGFyZ2V0IiwiY3VycmVudFdpbmRvdyIsInVuZGVmaW5lZCIsInRhcmdldERvYyIsImRvY3VtZW50IiwidGFyZ2V0SXNGcmllbmRseSIsInRhcmdldFdpbmRvdyIsImNvbSIsImFkdGVjaCIsIkFkdGVjaEN1c3RvbUFkJEFEX0lEJCIsImN1c3RvbUFkIiwicHJvdG90eXBlIiwiZWxlbSIsInRvcFdpbiIsInRvb2xzIiwiZXZlbnRzIiwidHJpZ2dlckV2ZW50IiwiZWwiLCJldmVudE5hbWUiLCJldmVudCIsImNyZWF0ZUV2ZW50IiwiaW5pdEV2ZW50IiwiY3JlYXRlRXZlbnRPYmplY3QiLCJldmVudFR5cGUiLCJkaXNwYXRjaEV2ZW50IiwiZmlyZUV2ZW50IiwiaHRtbEV2ZW50cyIsImFkZEV2ZW50IiwiaGFuZGxlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJhdHRhY2hFdmVudCIsInJlbW92ZUV2ZW50IiwicmVtb3ZldmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImRldGFjaEV2ZW50IiwibWFzayIsInZhbCIsImdldFBlcmNlbnRhZ2UiLCJudW0iLCJwZXJjZW50YWdlIiwiZ2V0U2l6ZVN0eWxlIiwic2l6ZSIsInByb2Nlc3NlZCIsInRoaXMiLCJwYXJzZUludCIsInNwbGl0IiwiZGF0YSIsImlzTmFOIiwicGFyc2VGbG9hdCIsIk1hdGgiLCJyb3VuZCIsImdldFZpZXdwb3J0U2l6ZSIsInciLCJpbm5lcldpZHRoIiwiaCIsImlubmVySGVpZ2h0IiwiZCIsImNvbXBhdE1vZGUiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImJvZHkiLCJkZWNsYXJlRXZlbnRzIiwiYWR2ZXJ0IiwiQURURUNIIiwicHJlSW5pdCIsImluaXQiLCJhZENvbnRhaW5lciIsImFuY2hvckRpdiIsImFkQ29udGVudCIsImFkSWZyYW1lIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJhZEJvZHkiLCJsaWIiLCJ1dGlscyIsIlV0aWxzXyRWRVJTSU9OJCIsImdsb2JhbEV2ZW50QnVzIiwiYWR0ZWNoQWRNYW5hZ2VyXyRWRVJTSU9OJCIsInJpY2hNZWRpYUV2ZW50IiwiUmljaE1lZGlhRXZlbnRfJFZFUlNJT04kIiwibWV0YURhdGEiLCJyZWNpZXZlTWV0YSIsInRvcFBvc2l0aW9uIiwic2Nyb2xsVG9wIiwid2luV2lkdGgiLCJ3aW5IZWlnaHQiLCJkb2NIZWlnaHQiLCJ3aGVuUmVhZHkiLCJoYW5kbGVQYXJlbnREYXRhIiwic2VuZE1ldGEiLCJzZXR1cFNjcm9sbERhdGEiLCJnZXRBZFdyYXBwZXJQb3NpdGlvbiIsInNldEFkSGVpZ2h0Iiwic2V0dXBSZXNpemUiLCJtZXRhIiwiZXZlbnRCdXMiLCJzZXRJbnRlcnZhbCIsImVsZW1lbnQiLCJib2R5UmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImVsZW1SZWN0IiwiZ2V0U2Nyb2xsVG9wIiwiZG9jIiwicGFnZVlPZmZzZXQiLCJjbGllbnRUb3AiLCJ3aGVlbCIsIkRhdGUiLCJnZXRUaW1lIiwid2luU2l6ZSIsImdldFdpbmRvd1NpemUiLCJ3aWR0aCIsImhlaWdodCIsImxvZyIsImciLCJ0b3BXcmFwcGVyIiwiY29udGVudFdyYXBwZXIiLCJpZnJhbWUiLCJkb2NCb2R5Iiwic3R5bGUiLCJjbGlwIiwicG9zaXRpb24iLCJsZWZ0IiwiYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXMiLCJpbnN0YW5jZUluZGV4IiwibGVuZ3RoIiwiYWR0ZWNoQWRDYWxsYmFja3MiLCJhZFNlcnZlclZhcnMiLCJ1aWQiLCJwdXNoIiwiYWR0ZWNoQWRDb25maWciXSwibWFwcGluZ3MiOiJDQUtBLFNBQVVBLEdBTVIsSUFBS0EsRUFBU0MsUUFBUyxDQUNyQkQsRUFBU0UsZ0JBQWdCQyxLQUFLQyxjQUFlLENBQzdDLEtBQ0UsR0FBSUMsS0FBY0MsT0FBT0MsYUFDckJDLEVBQVlILEVBQWNDLE9BQU9DLGFBQWFFLFdBQVdDLFdBQVdBLFdBQVdDLGNBQWdCTCxNQUNuR04sR0FBU1ksVUFBWVosRUFBU1ksY0FDOUJaLEVBQVNZLFVBQVVDLG9CQUFzQkwsRUFDekMsTUFBTU0sR0FDTkMsUUFBUUMsS0FBSyxtRkFBb0ZGLElBSXJHLEdBQUlHLElBQW1CLENBQ3ZCLEtBQUtqQixFQUFTWSxXQUFhWixFQUFTWSxVQUFVQyxxQkFBdUJLLEtBQ25FLElBQUssR0FBSUMsS0FBTW5CLEdBQVNFLGdCQUN0QixHQUFJRixFQUFTRSxnQkFBZ0JrQixlQUFlRCxHQUFLLENBQy9DLEdBQUlFLEdBQVlyQixFQUFTRSxnQkFBZ0JpQixFQUN6QyxJQUFzQixhQUFsQkUsRUFBVUMsTUFBdUJELEVBQVVqQixhQUFjLENBQzNEYSxHQUFtQixDQUNuQixRQU1SLEdBQUlqQixFQUFTWSxXQUFhWixFQUFTWSxVQUFVQyxvQkFBcUIsQ0FDaEUsR0FBSUEsR0FBc0JiLEVBQVNZLFVBQVVDLG1CQUM3Q0EsR0FBdUQsbUJBQXpCVSx3QkFBd0NMLE1BQVFNLElBQzFFWCxFQUFvQlksT0FBU1osTUFDNUIsQ0FHTCxJQUZBLEdBQUlhLEdBQW1CLEtBQ25CQyxFQUFnQkYsV0FDSUcsSUFBakJELEdBQTRCLENBQ2pDLElBQ0UsR0FBSUUsR0FBWUYsRUFBY0csUUFDMUJELEtBQ0ZILEVBQW1CQyxHQUVyQixNQUFN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RUFBYW9ILHdCQUEwQnBILEVBQWFvSCwyQkFDcEQsSUFBSUMsR0FBZ0JySCxFQUFhb0gsd0JBQXdCRSxNQUN6RHRILEdBQWFvSCx3QkFBd0JDLEdBQWlCLEdBQUlySCxHQUFhQyxJQUFJQyxPQUFPQyxzQkFFbEZILEVBQWF1SCxrQkFBb0J2SCxFQUFhdUgsc0JBQzlDdkgsRUFBYXVILGtCQUFrQnZKLEVBQVN3SixhQUFhQyxLQUNqRHpILEVBQWF1SCxrQkFBa0J2SixFQUFTd0osYUFBYUMsU0FDekR6SCxFQUFhdUgsa0JBQWtCdkosRUFBU3dKLGFBQWFDLEtBQUtDLEtBQ3REMUgsRUFBYW9ILHdCQUF3QkMsS0FDeENNIiwiZmlsZSI6ImN1c3RvbUFkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBCb2lsZXJwbGF0ZSBjb2RlIHJlcXVpcmVkIHRvIGhvb2sgaW50byB0aGUgQURURUNIIHJpY2ggbWVkaWEgbGlicmFyeS5cbiAqXG4gKiBGb3IgQVBJIGRvY3VtZW50YXRpb24sIHBsZWFzZSBjb250YWN0IGNhbnZhcy1oZWxwQGFkdGVjaC5jb21cbiAqL1xuKGZ1bmN0aW9uKGFkQ29uZmlnKSB7XG5cbiAgLypcbiAgICogVmlkaWJsZSBjaGVja1xuICAgKiBUaGlzIGFzc2lnbnMgdGhlIHZpZGlibGUgcGFyZW50IHdpbmRvdyBhcyB0aGUgdGFyZ2V0IHdpbmRvd1xuICAgKi9cbiAgaWYgKCFhZENvbmZpZy5wcmV2aWV3KSB7XG4gICAgYWRDb25maWcuYXNzZXRDb250YWluZXJzLm1haW4uaXNFeHBhbmRhYmxlID0gdHJ1ZTtcbiAgICB0cnkge1xuICAgICAgdmFyIHBhcmVudENoZWNrID0gd2luZG93LmZyYW1lRWxlbWVudCA/IHRydWUgOiBmYWxzZTtcbiAgICAgIHZhciB0YXJnZXRXaW4gPSBwYXJlbnRDaGVjayA/IHdpbmRvdy5mcmFtZUVsZW1lbnQucGFyZW50Tm9kZS5maXJzdENoaWxkLmZpcnN0Q2hpbGQuY29udGVudFdpbmRvdyA6IHdpbmRvdztcbiAgICAgIGFkQ29uZmlnLm92ZXJyaWRlcyA9IGFkQ29uZmlnLm92ZXJyaWRlcyB8fCB7fTtcbiAgICAgIGFkQ29uZmlnLm92ZXJyaWRlcy5kaXNwbGF5V2luZG93VGFyZ2V0ID0gdGFyZ2V0V2luO1xuICAgIH0gY2F0Y2goZSkge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gZmluZCB0YXJnZXQgaWZyYW1lIGluIHBsYXllciBlbnZpcm9ubWVudDogSGFzIHRoZSBzdHJ1Y3R1cmUgY2hhbmdlZD9cXG4nLCBlKTtcbiAgICB9XG4gIH1cbiAgXG4gIHZhciByZXF1aXJlc0JyZWFrb3V0ID0gZmFsc2U7XG4gIGlmICghYWRDb25maWcub3ZlcnJpZGVzIHx8IGFkQ29uZmlnLm92ZXJyaWRlcy5kaXNwbGF5V2luZG93VGFyZ2V0ICE9IHNlbGYpIHtcbiAgICBmb3IgKHZhciBpZCBpbiBhZENvbmZpZy5hc3NldENvbnRhaW5lcnMpIHtcbiAgICAgIGlmIChhZENvbmZpZy5hc3NldENvbnRhaW5lcnMuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICAgIHZhciBjb250YWluZXIgPSBhZENvbmZpZy5hc3NldENvbnRhaW5lcnNbaWRdO1xuICAgICAgICBpZiAoY29udGFpbmVyLnR5cGUgIT0gJ2lubGluZURpdicgfHwgY29udGFpbmVyLmlzRXhwYW5kYWJsZSkge1xuICAgICAgICAgIHJlcXVpcmVzQnJlYWtvdXQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKGFkQ29uZmlnLm92ZXJyaWRlcyAmJiBhZENvbmZpZy5vdmVycmlkZXMuZGlzcGxheVdpbmRvd1RhcmdldCkge1xuICAgIHZhciBkaXNwbGF5V2luZG93VGFyZ2V0ID0gYWRDb25maWcub3ZlcnJpZGVzLmRpc3BsYXlXaW5kb3dUYXJnZXQ7XG4gICAgZGlzcGxheVdpbmRvd1RhcmdldCA9ICh0eXBlb2YgYWR0ZWNoSWZyYW1lSGFzaEFycmF5ICE9ICd1bmRlZmluZWQnICYmIHNlbGYgIT0gdG9wKSA/XG4gICAgICAgIGRpc3BsYXlXaW5kb3dUYXJnZXQucGFyZW50IDogZGlzcGxheVdpbmRvd1RhcmdldDtcbiAgfSBlbHNlIHtcbiAgICB2YXIgY2FsY3VsYXRlZFRhcmdldCA9IG51bGw7XG4gICAgdmFyIGN1cnJlbnRXaW5kb3cgPSBwYXJlbnQ7XG4gICAgd2hpbGUgKGN1cnJlbnRXaW5kb3cgIT0gdW5kZWZpbmVkKSB7XG4gICAgICB0cnkge1xuICAgICAgICB2YXIgdGFyZ2V0RG9jID0gY3VycmVudFdpbmRvdy5kb2N1bWVudDtcbiAgICAgICAgaWYgKHRhcmdldERvYykge1xuICAgICAgICAgIGNhbGN1bGF0ZWRUYXJnZXQgPSBjdXJyZW50V2luZG93O1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoKGUpIHt9XG4gICAgICBjdXJyZW50V2luZG93ID0gKGN1cnJlbnRXaW5kb3cgPT0gdG9wKSA/IG51bGwgOiBjdXJyZW50V2luZG93LnBhcmVudDtcbiAgICB9XG4gICAgdmFyIGRpc3BsYXlXaW5kb3dUYXJnZXQgPSBjYWxjdWxhdGVkVGFyZ2V0IHx8IHRvcDtcbiAgfVxuXG4gIHZhciB0YXJnZXRJc0ZyaWVuZGx5ID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgdmFyIHRhcmdldERvYyA9IGRpc3BsYXlXaW5kb3dUYXJnZXQuZG9jdW1lbnQ7XG4gICAgaWYgKHRhcmdldERvYykge1xuICAgICAgdGFyZ2V0SXNGcmllbmRseSA9IHRydWU7XG4gICAgfVxuICB9IGNhdGNoKGUpIHt9XG5cbiAgdmFyIHRhcmdldFdpbmRvdyA9IChyZXF1aXJlc0JyZWFrb3V0ICYmIChzZWxmICE9IHRvcCAmJiB0YXJnZXRJc0ZyaWVuZGx5KSkgP1xuICAgICAgICAgIGRpc3BsYXlXaW5kb3dUYXJnZXQgOiBzZWxmO1xuICBcbiAgdGFyZ2V0V2luZG93LmNvbSA9IHRhcmdldFdpbmRvdy5jb20gfHwge307XG4gIHRhcmdldFdpbmRvdy5jb20uYWR0ZWNoID0gdGFyZ2V0V2luZG93LmNvbS5hZHRlY2ggfHwge307XG5cbiAgLypcbiAgICogQ3VzdG9tQWQuanMgQ29uc3RydWN0b3JcbiAgICovXG4gIHRhcmdldFdpbmRvdy5jb20uYWR0ZWNoLkFkdGVjaEN1c3RvbUFkJEFEX0lEJCA9IGZ1bmN0aW9uKCkge307XG4gIFxuICAvKlxuICAgKiBJbmNsdWRlIHBhcnRpYWxzXG4gICAqL1xuICAvLyBDb3JlIGNsYXNzXG4gIC8qKlxuICAgKiBDdXN0b21BZC5qcyBQcm90b3R5cGUgLSBhdHRhY2hlZCB0byBDdXN0b21BZCBwcm90b3R5cGVcbiAgICovXG4gIHZhciBjdXN0b21BZCA9IHRhcmdldFdpbmRvdy5jb20uYWR0ZWNoLkFkdGVjaEN1c3RvbUFkJEFEX0lEJDtcbiAgXG4gIC8vIEFkZCB3aW5kb3cgb2JqZWN0cyB0byBlbGVtZW50cyBwcm9wZXJ0eVxuICBjdXN0b21BZC5wcm90b3R5cGUuZWxlbSA9IHt9O1xuICBjdXN0b21BZC5wcm90b3R5cGUuZWxlbS50b3BXaW4gPSB3aW5kb3cucGFyZW50O1xuICBjdXN0b21BZC5wcm90b3R5cGUuZWxlbS50YXJnZXRXaW5kb3cgPSB0YXJnZXRXaW5kb3c7XG4gIFxuICAvLyBUb29sa2l0XG4gIC8qKlxuICAgKiBDdXN0b20gQWQgVG9vbHNcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS50b29scyA9IHtcbiAgICBldmVudHMgOiB7XG4gICAgICB0cmlnZ2VyRXZlbnQgOiBmdW5jdGlvbihlbCwgZXZlbnROYW1lKXtcbiAgICAgICAgdmFyIGV2ZW50O1xuICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcbiAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdIVE1MRXZlbnRzJyk7XG4gICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KGV2ZW50TmFtZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QpIHsvLyBJRSA8IDlcbiAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG4gICAgICAgICAgZXZlbnQuZXZlbnRUeXBlID0gZXZlbnROYW1lO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LmV2ZW50TmFtZSA9IGV2ZW50TmFtZTtcbiAgICAgICAgaWYgKGVsLmRpc3BhdGNoRXZlbnQpIHtcbiAgICAgICAgICBlbC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfSBlbHNlIGlmIChlbC5maXJlRXZlbnQgJiYgaHRtbEV2ZW50c1snb24nK2V2ZW50TmFtZV0pIHsvLyBJRSA8IDlcbiAgICAgICAgICBlbC5maXJlRXZlbnQoJ29uJytldmVudC5ldmVudFR5cGUsZXZlbnQpOy8vIGNhbiB0cmlnZ2VyIG9ubHkgcmVhbCBldmVudCAoZS5nLiAnY2xpY2snKVxuICAgICAgICB9IGVsc2UgaWYgKGVsW2V2ZW50TmFtZV0pe1xuICAgICAgICAgIGVsW2V2ZW50TmFtZV0oKTtcbiAgICAgICAgfSBlbHNlIGlmIChlbFsnb24nK2V2ZW50TmFtZV0pIHtcbiAgICAgICAgICBlbFsnb24nK2V2ZW50TmFtZV0oKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGFkZEV2ZW50IDogZnVuY3Rpb24oZWwsIHR5cGUsIGhhbmRsZXIpe1xuICAgICAgICBpZiAoZWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIodHlwZSxoYW5kbGVyLGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIGlmIChlbC5hdHRhY2hFdmVudCAmJiBodG1sRXZlbnRzWydvbicrdHlwZV0pey8vIElFIDwgOVxuICAgICAgICAgIGVsLmF0dGFjaEV2ZW50KCdvbicrdHlwZSxoYW5kbGVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbFsnb24nK3R5cGVdPWhhbmRsZXI7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZW1vdmVFdmVudCA6IGZ1bmN0aW9uKGVsLCB0eXBlLCBoYW5kbGVyKXtcbiAgICAgICAgaWYoZWwucmVtb3ZldmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLGhhbmRsZXIsZmFsc2UpO1xuICAgICAgICB9IGVsc2UgaWYgKGVsLmRldGFjaEV2ZW50ICYmIGh0bWxFdmVudHNbJ29uJyt0eXBlXSl7Ly8gSUUgPCA5XG4gICAgICAgICAgZWwuZGV0YWNoRXZlbnQoJ29uJyt0eXBlLGhhbmRsZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsWydvbicrdHlwZV09bnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgbWFzayA6IGZ1bmN0aW9uKGVsZW0sIHZhbCkge1xuICAgICAgLy8gZWxlbS5zdHlsZS5jbGlwID0gJ3JlY3QoJyt2YWwrJyknO1xuICAgIH0sXG4gICAgZ2V0UGVyY2VudGFnZSA6IGZ1bmN0aW9uKG51bSwgcGVyY2VudGFnZSkge1xuICAgICAgcmV0dXJuIChudW0gLyAxMDApICogcGVyY2VudGFnZTtcbiAgICB9LFxuICAgIC8qXG4gICAgICogUmV0dXJuIHBpeGVsICsgcGVyY2VudCB2YWx1ZXMgZnJvbSBpbnRlZ2VyIC8gc3RyaW5nICwgZWcgJzEwJSdcbiAgICAgKi9cbiAgICBnZXRTaXplU3R5bGUgOiBmdW5jdGlvbih2YWwsIHNpemUpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHZhbCwgc2l6ZSlcbiAgICAgIHZhciB0b29scyA9IHRoaXMudG9vbHM7XG4gICAgICB2YXIgcHJvY2Vzc2VkID0ge307XG4gICAgICB2YXIgbnVtID0gcGFyc2VJbnQodmFsLCAxMCk7XG4gICAgICB2YXIgdmFsID0gdmFsLnNwbGl0KG51bSlbMV07XG4gICAgICBkYXRhID0ge1xuICAgICAgICBudW0gOiAoaXNOYU4ocGFyc2VGbG9hdCgobnVtKSkpID8gMCA6IG51bSksXG4gICAgICAgIHZhbCA6ICh0eXBlb2YgdmFsIT09J3VuZGVmaW5lZCcgPyB2YWwgOiAncHgnKVxuICAgICAgfVxuICAgICAgaWYgKGRhdGEudmFsPT0nJScpIHtcbiAgICAgICAgcHJvY2Vzc2VkWydweCddID0gTWF0aC5yb3VuZCgoc2l6ZSAvIDEwMCkgKiBkYXRhLm51bSk7XG4gICAgICAgIHByb2Nlc3NlZFsncGVyY2VudCddID0gZGF0YS5udW07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9jZXNzZWRbJ3B4J10gPSBkYXRhLm51bTtcbiAgICAgICAgcHJvY2Vzc2VkWydwZXJjZW50J10gPSBkYXRhLm51bSAvIHNpemUgKiAxMDA7XG4gICAgICB9XG4gICAgICByZXR1cm4gcHJvY2Vzc2VkO1xuICAgIH0sXG4gICAgZ2V0Vmlld3BvcnRTaXplIDogZnVuY3Rpb24odykge1xuICAgICAgLy8gVXNlIHRoZSBzcGVjaWZpZWQgd2luZG93IG9yIHRoZSBjdXJyZW50IHdpbmRvdyBpZiBubyBhcmd1bWVudFxuICAgICAgdyA9IHcgfHwgd2luZG93O1xuICBcbiAgICAgIC8vIFRoaXMgd29ya3MgZm9yIGFsbCBicm93c2VycyBleGNlcHQgSUU4IGFuZCBiZWZvcmVcbiAgICAgIGlmICh3LmlubmVyV2lkdGggIT0gbnVsbCkgcmV0dXJuIHsgdzogdy5pbm5lcldpZHRoLCBoOiB3LmlubmVySGVpZ2h0IH07XG4gIFxuICAgICAgLy8gRm9yIElFIChvciBhbnkgYnJvd3NlcikgaW4gU3RhbmRhcmRzIG1vZGVcbiAgICAgIHZhciBkID0gdy5kb2N1bWVudDtcbiAgICAgIGlmIChkb2N1bWVudC5jb21wYXRNb2RlID09IFwiQ1NTMUNvbXBhdFwiKVxuICAgICAgICAgIHJldHVybiB7IHc6IGQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgIGg6IGQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCB9O1xuICBcbiAgICAgIC8vIEZvciBicm93c2VycyBpbiBRdWlya3MgbW9kZVxuICAgICAgcmV0dXJuIHsgdzogZC5ib2R5LmNsaWVudFdpZHRoLCBoOiBkLmJvZHkuY2xpZW50SGVpZ2h0IH07XG4gICAgfVxuICB9O1xuICBcbiAgLyoqXG4gICAqIEV2ZW50cyBsaXN0XG4gICAqIFRoaXMgbWV0aG9kIGlzIG5ldmVyIHVzZWQsIG9ubHkgaGVyZSBmb3IgT05FIHRvIHBhcnNlXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUuZGVjbGFyZUV2ZW50cyA9IGZ1bmN0aW9uKGFkdmVydCkge1xuICAgIFxuICAgIC8vIFBhcmVudCBldmVudHNcbiAgICBBRFRFQ0guZXZlbnQoJ1JZT1RfUEFSRU5UX01FVEEnKTtcbiAgICBBRFRFQ0guZXZlbnQoJ1JZT1RfUkVTSVpFJyk7XG4gIFxuICAgIC8vIENoaWxkIGV2ZW50c1xuICAgIEFEVEVDSC5ldmVudCgnUllPVF9DSElMRF9NRVRBJyk7XG4gIFxuICB9O1xuICBcbiAgLyoqXG4gICAqIHByZUluaXQgTWV0aG9kXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUucHJlSW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh3aW5kb3c9PW51bGwpIHJldHVybjtcbiAgICB3aW5kb3cuY29tID0gY29tIHx8IHt9O1xuICAgIGNvbS5hZHRlY2ggPSB3aW5kb3cuY29tLmFkdGVjaDtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBJbml0IGN1c3RvbUFkXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKGFkdmVydCkge1xuICAgIFxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgXG4gICAgLy8gQURURUNIIGFkdmVydCBkYXRhIG9iamVjdFxuICAgIHRoaXMuYWR2ZXJ0ID0gYWR2ZXJ0O1xuICBcbiAgICAvLyBFbGVtZW50c1xuICAgIHRoaXMuZWxlbS5hZENvbnRhaW5lciA9IGFkdmVydC5hc3NldENvbnRhaW5lcnMubWFpbi5hbmNob3JEaXY7XG4gICAgdGhpcy5lbGVtLmFkQ29udGVudCA9IGFkdmVydC5hc3NldENvbnRhaW5lcnMubWFpbi5hbmNob3JEaXYuZmlyc3RDaGlsZDtcbiAgICB0aGlzLmVsZW0uYWRJZnJhbWUgPSB0aGlzLmVsZW0uYWRDb250ZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpZnJhbWUnKVswXTtcbiAgICB0aGlzLmVsZW0uYWRCb2R5ID0gZG9jdW1lbnQgfHwgdGhpcy5lbGVtLmFkSWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gIFxuICAgIC8vIEFEVEVDSCBsaWJyYXJpZXNcbiAgICB0aGlzLmxpYiA9IHt9O1xuICAgIHRoaXMubGliLnV0aWxzID0gdGFyZ2V0V2luZG93LmNvbS5hZHRlY2guVXRpbHNfJFZFUlNJT04kO1xuICAgIHRoaXMubGliLmdsb2JhbEV2ZW50QnVzID0gdGFyZ2V0V2luZG93LmFkdGVjaEFkTWFuYWdlcl8kVkVSU0lPTiQuZ2xvYmFsRXZlbnRCdXM7XG4gICAgdGhpcy5saWIucmljaE1lZGlhRXZlbnQgPSB0YXJnZXRXaW5kb3cuY29tLmFkdGVjaC5SaWNoTWVkaWFFdmVudF8kVkVSU0lPTiQ7XG4gIFxuICAgIC8vIE1ldGEgZGF0YSB0byBwYXNzIHRvIGNoaWxkXG4gICAgdGhpcy5tZXRhRGF0YSA9IHt9O1xuICBcbiAgICAvLyBTZXR1cCByZWNpZXZlclxuICAgIHRoaXMucmVjaWV2ZU1ldGEoKTsgIFxuICB9O1xuICBcbiAgLyoqXG4gICAqIFBhcmVudCBkYXRhIG9iamVjdFxuICAgKi9cbiAgY3VzdG9tQWQucHJvdG90eXBlLmRhdGEgPSB7XG4gICAgdG9wUG9zaXRpb24gOiAwLFxuICAgIHNjcm9sbFRvcCA6IDAsXG4gICAgd2luV2lkdGggOiAwLFxuICAgIHdpbkhlaWdodCA6IDAsXG4gICAgZG9jSGVpZ2h0IDogMFxuICB9XG4gIFxuICAvKipcbiAgICogQ2hpbGQgZGF0YVxuICAgKi9cbiAgLy8gY3VzdG9tQWQucHJvdG90eXBlLmNoaWxkRGF0YSA9IHt9XG4gIFxuICAvKipcbiAgICogRmlyZSB0aGlzIHN0dWZmIHdoZW4gcmVhZHkgKGNoaWxkIG1ldGEgaXMgcmVjaWV2ZWQpXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUud2hlblJlYWR5ID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gUHJvY2VzcyBkYXRhIGZyb20gcGFyZW50XG4gICAgdGhpcy5oYW5kbGVQYXJlbnREYXRhKCk7XG4gICAgLy8gU2V0dXAgZGlzcGF0Y2hlclxuICAgIHRoaXMuc2VuZE1ldGEoKTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBIYW5kbGUgUGFyZW50IGRhdGFcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5oYW5kbGVQYXJlbnREYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gU2Nyb2xsIHBvc2l0aW9uXG4gICAgdGhpcy5zZXR1cFNjcm9sbERhdGEoKTtcbiAgICAvLyBHZXQgQWQgd3JhcHBlciBwb3NpdGlvbiBkYXRhXG4gICAgdGhpcy5nZXRBZFdyYXBwZXJQb3NpdGlvbigpO1xuICAgIC8vIFNldCBhZHZlcnQgd3JhcHBlciBoZWlnaHRcbiAgICB0aGlzLnNldEFkSGVpZ2h0KCk7XG4gICAgLy8gU2V0dXAgcmVzaXplIGV2ZW50XG4gICAgdGhpcy5zZXR1cFJlc2l6ZSgpO1xuICB9XG4gIFxuICAvKipcbiAgICogRGlzcGF0Y2ggZXZlbnQgdG8gY2hpbGRcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24oZXZlbnROYW1lLCBkYXRhKSB7XG4gICAgdmFyIHJpY2hNZWRpYUV2ZW50ID0gbmV3IHRoaXMubGliLnJpY2hNZWRpYUV2ZW50KGV2ZW50TmFtZSk7XG4gICAgdmFyIGRhdGEgPSBkYXRhIHx8IHt9O1xuICAgIHJpY2hNZWRpYUV2ZW50Lm1ldGEgPSBkYXRhO1xuICAgIHRoaXMuYWR2ZXJ0LmV2ZW50QnVzLmRpc3BhdGNoRXZlbnQocmljaE1lZGlhRXZlbnQpO1xuICB9XG4gIFxuICAvKipcbiAgICogU2VuZCBtZXRhIGRhdGEgdG8gY2hpbGQgKGFkdmVydClcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5zZW5kTWV0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnUllPVF9QQVJFTlRfTUVUQScsIHNlbGYuZGF0YSk7XG4gICAgfSwgMTAwKTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBSZWNpZXZlIG1ldGEgZGF0YSBmcm9tIGNoaWxkXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUucmVjaWV2ZU1ldGEgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5hZHZlcnQuZXZlbnRCdXMuYWRkRXZlbnRMaXN0ZW5lcignUllPVF9DSElMRF9NRVRBJywgZnVuY3Rpb24oZSkge1xuICAgICAgc2VsZi5kYXRhLmRvY0hlaWdodCA9IGUubWV0YS5kb2NIZWlnaHQ7XG4gICAgICAvLyBTZXQgYWR2ZXJ0IHdyYXBwZXIgaGVpZ2h0XG4gICAgICBzZWxmLnNldEFkSGVpZ2h0KGUubWV0YS5kb2NIZWlnaHQpO1xuICAgICAgLy8gTWV0YSBpcyByZWFkeSwgc28gZmlyZVxuICAgICAgc2VsZi53aGVuUmVhZHkoKTtcbiAgICB9KTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5nZXRBZFdyYXBwZXJQb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtLmFkQ29udGFpbmVyO1xuICAgIHZhciBib2R5UmVjdCA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgIGVsZW1SZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgdG9wID0gZWxlbVJlY3QudG9wIC0gYm9keVJlY3QudG9wO1xuICAgIHRoaXMuZGF0YS50b3BQb3NpdGlvbiA9IHRvcDtcbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5zZXR1cFNjcm9sbERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdzY3JvbGwnLCB3aGVlbCwgZmFsc2UgKTtcbiAgICBmdW5jdGlvbiBnZXRTY3JvbGxUb3AoKSB7XG4gICAgICB2YXIgZG9jID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgdmFyIHRvcCA9ICh3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jLnNjcm9sbFRvcCkgIC0gKGRvYy5jbGllbnRUb3AgfHwgMCk7XG4gICAgICByZXR1cm4gdG9wO1xuICAgIH1cbiAgICB2YXIgbGFzdE9mZnNldCA9IGdldFNjcm9sbFRvcCgpO1xuICAgIHZhciBsYXN0RGF0ZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIGZ1bmN0aW9uIHdoZWVsKGUpIHtcbiAgICAgIHNlbGYuZGF0YS5zY3JvbGxUb3AgPSBnZXRTY3JvbGxUb3AoKTtcbiAgICB9XG4gICAgdGhpcy5kYXRhLnNjcm9sbFRvcCA9IGdldFNjcm9sbFRvcCgpO1xuICB9XG4gIFxuICBjdXN0b21BZC5wcm90b3R5cGUuc2V0dXBSZXNpemUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHdpblNpemUgPSBzZWxmLmdldFdpbmRvd1NpemUoKTtcbiAgICBzZWxmLmRhdGEud2luV2lkdGggPSB3aW5TaXplLndpZHRoO1xuICAgIHNlbGYuZGF0YS53aW5IZWlnaHQgPSB3aW5TaXplLmhlaWdodDtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24oKXtcbiAgICAgIHZhciB3aW5TaXplID0gc2VsZi5nZXRXaW5kb3dTaXplKCk7XG4gICAgICBzZWxmLmRhdGEud2luV2lkdGggPSB3aW5TaXplLndpZHRoO1xuICAgICAgc2VsZi5kYXRhLndpbkhlaWdodCA9IHdpblNpemUuaGVpZ2h0O1xuICAgICAgc2VsZi5zZXRBZEhlaWdodChzZWxmLmRhdGEuZG9jSGVpZ2h0KTtcbiAgICAgIC8vIHNlbGYuZXZlbnRCdXMuYWRkVG9RdWV1ZSgncmVzaXplJyk7XG4gICAgICBjb25zb2xlLmxvZyhcInJlc2l6ZVwiKTtcbiAgICB9LCB0cnVlKTtcbiAgfTtcbiAgXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5nZXRXaW5kb3dTaXplID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHcgPSB3aW5kb3csXG4gICAgICAgIGQgPSBkb2N1bWVudCxcbiAgICAgICAgZSA9IGQuZG9jdW1lbnRFbGVtZW50LFxuICAgICAgICBnID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdLFxuICAgICAgICB4ID0gdy5pbm5lcldpZHRoIHx8IGUuY2xpZW50V2lkdGggfHwgZy5jbGllbnRXaWR0aCxcbiAgICAgICAgeSA9IHcuaW5uZXJIZWlnaHR8fCBlLmNsaWVudEhlaWdodHx8IGcuY2xpZW50SGVpZ2h0O1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aCA6IHgsXG4gICAgICBoZWlnaHQgOiB5XG4gICAgfTtcbiAgfTtcbiAgXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5zZXRBZEhlaWdodCA9IGZ1bmN0aW9uKGhlaWdodCkge1xuICBcbiAgICB2YXIgdG9wV3JhcHBlciA9IHRoaXMuZWxlbS5hZENvbnRhaW5lcjtcbiAgICB2YXIgY29udGVudFdyYXBwZXIgPSB0aGlzLmVsZW0uYWRDb250ZW50O1xuICAgIHZhciBpZnJhbWUgPSBjb250ZW50V3JhcHBlci5maXJzdENoaWxkO1xuICAgIHZhciBkb2NCb2R5ID0gdGhpcy5lbGVtLmRvY0JvZHk7XG4gIFxuICAgIC8vIFRvcCB3cmFwcGVyXG4gICAgdG9wV3JhcHBlci5zdHlsZS53aWR0aCA9IFwiYXV0b1wiO1xuICAgIHRvcFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gXCJhdXRvXCI7XG4gIFxuICAgIC8vIFN0eWxlXG4gICAgY29udGVudFdyYXBwZXIuc3R5bGUuY2xpcCA9IFwiXCI7XG4gICAgdG9wV3JhcHBlci5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcbiAgICB0b3BXcmFwcGVyLnN0eWxlLmxlZnQgPSAwO1xuICAgIHRvcFdyYXBwZXIuc3R5bGUudG9wID0gMDtcbiAgXG4gICAgaWYgKGhlaWdodCE9PXRoaXMuZGF0YS5kb2NIZWlnaHQpIHtcbiAgXG4gICAgICBoZWlnaHQgPSB0aGlzLmRhdGEuZG9jSGVpZ2h0O1xuICBcbiAgICAgIC8vIHRvcFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gMCArIFwicHhcIjtcbiAgICAgIHRvcFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgXCJweFwiO1xuICAgICAgLy8gXG4gICAgICAvLyBjb250ZW50V3JhcHBlci5zdHlsZS5oZWlnaHQgPSAwICsgXCJweFwiO1xuICAgICAgY29udGVudFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgXCJweFwiO1xuICAgICAgLy8gXG4gICAgICAvLyBpZnJhbWUuc3R5bGUuaGVpZ2h0ID0gMCArIFwicHhcIjtcbiAgICAgIGlmcmFtZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyBcInB4XCI7XG4gICAgfVxuICB9LFxuXG4gIHRhcmdldFdpbmRvdy5hZHRlY2hDYWxsYmFja0luc3RhbmNlcyA9IHRhcmdldFdpbmRvdy5hZHRlY2hDYWxsYmFja0luc3RhbmNlcyB8fCBbXTtcbiAgdmFyIGluc3RhbmNlSW5kZXggPSB0YXJnZXRXaW5kb3cuYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXMubGVuZ3RoO1xuICB0YXJnZXRXaW5kb3cuYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXNbaW5zdGFuY2VJbmRleF0gPSBuZXcgdGFyZ2V0V2luZG93LmNvbS5hZHRlY2guQWR0ZWNoQ3VzdG9tQWQkQURfSUQkKCk7XG5cbiAgdGFyZ2V0V2luZG93LmFkdGVjaEFkQ2FsbGJhY2tzID0gdGFyZ2V0V2luZG93LmFkdGVjaEFkQ2FsbGJhY2tzIHx8IHt9O1xuICB0YXJnZXRXaW5kb3cuYWR0ZWNoQWRDYWxsYmFja3NbYWRDb25maWcuYWRTZXJ2ZXJWYXJzLnVpZF0gPVxuICAgICAgdGFyZ2V0V2luZG93LmFkdGVjaEFkQ2FsbGJhY2tzW2FkQ29uZmlnLmFkU2VydmVyVmFycy51aWRdIHx8IFtdO1xuICB0YXJnZXRXaW5kb3cuYWR0ZWNoQWRDYWxsYmFja3NbYWRDb25maWcuYWRTZXJ2ZXJWYXJzLnVpZF0ucHVzaChcbiAgICAgIHRhcmdldFdpbmRvdy5hZHRlY2hDYWxsYmFja0luc3RhbmNlc1tpbnN0YW5jZUluZGV4XSk7XG59KShhZHRlY2hBZENvbmZpZyk7Il19
