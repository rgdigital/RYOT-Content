!function(t){if(!t.preview){t.assetContainers.main.isExpandable=!0;try{var e=!!window.frameElement,n=e?window.frameElement.parentNode.firstChild.firstChild.contentWindow:window;t.overrides=t.overrides||{},t.overrides.displayWindowTarget=n}catch(t){console.warn("Failed to find target iframe in player environment: Has the structure changed?\n",t)}}var i=!1;if(!t.overrides||t.overrides.displayWindowTarget!=self)for(var a in t.assetContainers)if(t.assetContainers.hasOwnProperty(a)){var o=t.assetContainers[a];if("inlineDiv"!=o.type||o.isExpandable){i=!0;break}}if(t.overrides&&t.overrides.displayWindowTarget){var d=t.overrides.displayWindowTarget;d="undefined"!=typeof adtechIframeHashArray&&self!=top?d.parent:d}else{for(var r=null,s=parent;void 0!=s;){try{var c=s.document;c&&(r=s)}catch(t){}s=s==top?null:s.parent}var d=r||top}var h=!1;try{var c=d.document;c&&(h=!0)}catch(t){}var l=i&&self!=top&&h?d:self;l.com=l.com||{},l.com.adtech=l.com.adtech||{},l.com.adtech.AdtechCustomAd$AD_ID$=function(){};var v=l.com.adtech.AdtechCustomAd$AD_ID$;v.prototype.elem={},v.prototype.elem.topWin=window.parent,v.prototype.elem.targetWindow=l,v.prototype.tools={events:{triggerEvent:function(t,e){var n;document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):document.createEventObject&&(n=document.createEventObject(),n.eventType=e),n.eventName=e,t.dispatchEvent?t.dispatchEvent(n):t.fireEvent&&htmlEvents["on"+e]?t.fireEvent("on"+n.eventType,n):t[e]?t[e]():t["on"+e]&&t["on"+e]()},addEvent:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&htmlEvents["on"+e]?t.attachEvent("on"+e,n):t["on"+e]=n},removeEvent:function(t,e,n){t.removeventListener?t.removeEventListener(e,n,!1):t.detachEvent&&htmlEvents["on"+e]?t.detachEvent("on"+e,n):t["on"+e]=null}},mask:function(t,e){},getPercentage:function(t,e){return t/100*e},getSizeStyle:function(t,e){var n=(this.tools,{}),i=parseInt(t,10),t=t.split(i)[1];return data={num:isNaN(parseFloat(i))?0:i,val:void 0!==t?t:"px"},"%"==data.val?(n.px=Math.round(e/100*data.num),n.percent=data.num):(n.px=data.num,n.percent=data.num/e*100),n},getViewportSize:function(t){if(t=t||window,null!=t.innerWidth)return{w:t.innerWidth,h:t.innerHeight};var e=t.document;return"CSS1Compat"==document.compatMode?{w:e.documentElement.clientWidth,h:e.documentElement.clientHeight}:{w:e.body.clientWidth,h:e.body.clientHeight}}},v.prototype.declareEvents=function(t){ADTECH.event("RYOT_PARENT_META"),ADTECH.event("RYOT_RESIZE"),ADTECH.event("RYOT_CHILD_META")},v.prototype.preInit=function(){null!=window&&(window.com=com||{},com.adtech=window.com.adtech)},v.prototype.init=function(t){this.advert=t,this.elem.adContainer=t.assetContainers.main.anchorDiv,this.elem.adContent=t.assetContainers.main.anchorDiv.firstChild,this.elem.adIframe=this.elem.adContent.getElementsByTagName("iframe")[0],this.elem.adBody=document||this.elem.adIframe.contentWindow.document,this.lib={},this.lib.utils=l.com.adtech.Utils_$VERSION$,this.lib.globalEventBus=l.adtechAdManager_$VERSION$.globalEventBus,this.lib.richMediaEvent=l.com.adtech.RichMediaEvent_$VERSION$,this.metaData={},this.recieveMeta()},v.prototype.data={topPosition:0,scrollTop:0,winWidth:0,winHeight:0,docHeight:0},v.prototype.whenReady=function(){this.handleParentData()},v.prototype.handleParentData=function(){this.setupScrollData(),this.getAdWrapperPosition(),this.setAdHeight(),this.setupResize(),this.sendMeta()},v.prototype.dispatchEvent=function(t,e){var n=new this.lib.richMediaEvent(t),e=e||{};n.meta=e,this.advert.eventBus.dispatchEvent(n)},v.prototype.sendMeta=function(){var t=this;setInterval(function(){t.dispatchEvent("RYOT_PARENT_META",t.data)},100)},v.prototype.recieveMeta=function(){var t=this;this.advert.eventBus.addEventListener("RYOT_CHILD_META",function(e){t.data.docHeight=e.meta.docHeight,t.setAdHeight(e.meta.docHeight),t.whenReady()})},v.prototype.getAdWrapperPosition=function(){var t=this.elem.adContainer,e=document.body.getBoundingClientRect(),n=t.getBoundingClientRect(),i=n.top-e.top;this.data.topPosition=i},v.prototype.setupScrollData=function(){function t(){var t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}function e(e){n.data.scrollTop=t()}var n=this;window.addEventListener("scroll",e,!1);t(),(new Date).getTime();this.data.scrollTop=t()},v.prototype.setupResize=function(){var t=this,e=t.getWindowSize();t.data.winWidth=e.width,t.data.winHeight=e.height,window.addEventListener("resize",function(){var e=t.getWindowSize();t.data.winWidth=e.width,t.data.winHeight=e.height,t.setIframeHeight(t.data.docHeight)},!0)},v.prototype.getWindowSize=function(){var t=window,e=document,n=e.documentElement,i=e.getElementsByTagName("body")[0];return{width:t.innerWidth||n.clientWidth||i.clientWidth,height:t.innerHeight||n.clientHeight||i.clientHeight}},v.prototype.setAdHeight=function(t){var e=this.elem.adContainer,n=this.elem.adContent,i=n.firstChild;this.elem.docBody;e.style.width="auto",e.style.height="auto",n.style.clip="",t!==this.data.docHeight&&(t=this.data.docHeight,e.style.height=t+"px",n.style.height=t+"px",i.style.height=t+"px")},l.adtechCallbackInstances=l.adtechCallbackInstances||[];var p=l.adtechCallbackInstances.length;l.adtechCallbackInstances[p]=new l.com.adtech.AdtechCustomAd$AD_ID$,l.adtechAdCallbacks=l.adtechAdCallbacks||{},l.adtechAdCallbacks[t.adServerVars.uid]=l.adtechAdCallbacks[t.adServerVars.uid]||[],l.adtechAdCallbacks[t.adServerVars.uid].push(l.adtechCallbackInstances[p])}(adtechAdConfig);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbUFkLndyYXBwZXIuanMiXSwibmFtZXMiOlsiYWRDb25maWciLCJwcmV2aWV3IiwiYXNzZXRDb250YWluZXJzIiwibWFpbiIsImlzRXhwYW5kYWJsZSIsInBhcmVudENoZWNrIiwid2luZG93IiwiZnJhbWVFbGVtZW50IiwidGFyZ2V0V2luIiwicGFyZW50Tm9kZSIsImZpcnN0Q2hpbGQiLCJjb250ZW50V2luZG93Iiwib3ZlcnJpZGVzIiwiZGlzcGxheVdpbmRvd1RhcmdldCIsImUiLCJjb25zb2xlIiwid2FybiIsInJlcXVpcmVzQnJlYWtvdXQiLCJzZWxmIiwiaWQiLCJoYXNPd25Qcm9wZXJ0eSIsImNvbnRhaW5lciIsInR5cGUiLCJhZHRlY2hJZnJhbWVIYXNoQXJyYXkiLCJ0b3AiLCJwYXJlbnQiLCJjYWxjdWxhdGVkVGFyZ2V0IiwiY3VycmVudFdpbmRvdyIsInVuZGVmaW5lZCIsInRhcmdldERvYyIsImRvY3VtZW50IiwidGFyZ2V0SXNGcmllbmRseSIsInRhcmdldFdpbmRvdyIsImNvbSIsImFkdGVjaCIsIkFkdGVjaEN1c3RvbUFkJEFEX0lEJCIsImN1c3RvbUFkIiwicHJvdG90eXBlIiwiZWxlbSIsInRvcFdpbiIsInRvb2xzIiwiZXZlbnRzIiwidHJpZ2dlckV2ZW50IiwiZWwiLCJldmVudE5hbWUiLCJldmVudCIsImNyZWF0ZUV2ZW50IiwiaW5pdEV2ZW50IiwiY3JlYXRlRXZlbnRPYmplY3QiLCJldmVudFR5cGUiLCJkaXNwYXRjaEV2ZW50IiwiZmlyZUV2ZW50IiwiaHRtbEV2ZW50cyIsImFkZEV2ZW50IiwiaGFuZGxlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJhdHRhY2hFdmVudCIsInJlbW92ZUV2ZW50IiwicmVtb3ZldmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImRldGFjaEV2ZW50IiwibWFzayIsInZhbCIsImdldFBlcmNlbnRhZ2UiLCJudW0iLCJwZXJjZW50YWdlIiwiZ2V0U2l6ZVN0eWxlIiwic2l6ZSIsInByb2Nlc3NlZCIsInRoaXMiLCJwYXJzZUludCIsInNwbGl0IiwiZGF0YSIsImlzTmFOIiwicGFyc2VGbG9hdCIsIk1hdGgiLCJyb3VuZCIsImdldFZpZXdwb3J0U2l6ZSIsInciLCJpbm5lcldpZHRoIiwiaCIsImlubmVySGVpZ2h0IiwiZCIsImNvbXBhdE1vZGUiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImJvZHkiLCJkZWNsYXJlRXZlbnRzIiwiYWR2ZXJ0IiwiQURURUNIIiwicHJlSW5pdCIsImluaXQiLCJhZENvbnRhaW5lciIsImFuY2hvckRpdiIsImFkQ29udGVudCIsImFkSWZyYW1lIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJhZEJvZHkiLCJsaWIiLCJ1dGlscyIsIlV0aWxzXyRWRVJTSU9OJCIsImdsb2JhbEV2ZW50QnVzIiwiYWR0ZWNoQWRNYW5hZ2VyXyRWRVJTSU9OJCIsInJpY2hNZWRpYUV2ZW50IiwiUmljaE1lZGlhRXZlbnRfJFZFUlNJT04kIiwibWV0YURhdGEiLCJyZWNpZXZlTWV0YSIsInRvcFBvc2l0aW9uIiwic2Nyb2xsVG9wIiwid2luV2lkdGgiLCJ3aW5IZWlnaHQiLCJkb2NIZWlnaHQiLCJ3aGVuUmVhZHkiLCJoYW5kbGVQYXJlbnREYXRhIiwic2V0dXBTY3JvbGxEYXRhIiwiZ2V0QWRXcmFwcGVyUG9zaXRpb24iLCJzZXRBZEhlaWdodCIsInNldHVwUmVzaXplIiwic2VuZE1ldGEiLCJtZXRhIiwiZXZlbnRCdXMiLCJzZXRJbnRlcnZhbCIsImVsZW1lbnQiLCJib2R5UmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImVsZW1SZWN0IiwiZ2V0U2Nyb2xsVG9wIiwiZG9jIiwicGFnZVlPZmZzZXQiLCJjbGllbnRUb3AiLCJ3aGVlbCIsIkRhdGUiLCJnZXRUaW1lIiwid2luU2l6ZSIsImdldFdpbmRvd1NpemUiLCJ3aWR0aCIsImhlaWdodCIsInNldElmcmFtZUhlaWdodCIsImciLCJ0b3BXcmFwcGVyIiwiY29udGVudFdyYXBwZXIiLCJpZnJhbWUiLCJkb2NCb2R5Iiwic3R5bGUiLCJjbGlwIiwiYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXMiLCJpbnN0YW5jZUluZGV4IiwibGVuZ3RoIiwiYWR0ZWNoQWRDYWxsYmFja3MiLCJhZFNlcnZlclZhcnMiLCJ1aWQiLCJwdXNoIiwiYWR0ZWNoQWRDb25maWciXSwibWFwcGluZ3MiOiJDQUtBLFNBQVVBLEdBTVIsSUFBS0EsRUFBU0MsUUFBUyxDQUNyQkQsRUFBU0UsZ0JBQWdCQyxLQUFLQyxjQUFlLENBQzdDLEtBQ0UsR0FBSUMsS0FBY0MsT0FBT0MsYUFDckJDLEVBQVlILEVBQWNDLE9BQU9DLGFBQWFFLFdBQVdDLFdBQVdBLFdBQVdDLGNBQWdCTCxNQUNuR04sR0FBU1ksVUFBWVosRUFBU1ksY0FDOUJaLEVBQVNZLFVBQVVDLG9CQUFzQkwsRUFDekMsTUFBTU0sR0FDTkMsUUFBUUMsS0FBSyxtRkFBb0ZGLElBSXJHLEdBQUlHLElBQW1CLENBQ3ZCLEtBQUtqQixFQUFTWSxXQUFhWixFQUFTWSxVQUFVQyxxQkFBdUJLLEtBQ25FLElBQUssR0FBSUMsS0FBTW5CLEdBQVNFLGdCQUN0QixHQUFJRixFQUFTRSxnQkFBZ0JrQixlQUFlRCxHQUFLLENBQy9DLEdBQUlFLEdBQVlyQixFQUFTRSxnQkFBZ0JpQixFQUN6QyxJQUFzQixhQUFsQkUsRUFBVUMsTUFBdUJELEVBQVVqQixhQUFjLENBQzNEYSxHQUFtQixDQUNuQixRQU1SLEdBQUlqQixFQUFTWSxXQUFhWixFQUFTWSxVQUFVQyxvQkFBcUIsQ0FDaEUsR0FBSUEsR0FBc0JiLEVBQVNZLFVBQVVDLG1CQUM3Q0EsR0FBdUQsbUJBQXpCVSx3QkFBd0NMLE1BQVFNLElBQzFFWCxFQUFvQlksT0FBU1osTUFDNUIsQ0FHTCxJQUZBLEdBQUlhLEdBQW1CLEtBQ25CQyxFQUFnQkYsV0FDSUcsSUFBakJELEdBQTRCLENBQ2pDLElBQ0UsR0FBSUUsR0FBWUYsRUFBY0csUUFDMUJELEtBQ0ZILEVBQW1CQyxHQUVyQixNQUFNYixJQUNS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QWFDLElBQUlDLE9BQU9DLHNCQUVsRkgsRUFBYXFILGtCQUFvQnJILEVBQWFxSCxzQkFDOUNySCxFQUFhcUgsa0JBQWtCckosRUFBU3NKLGFBQWFDLEtBQ2pEdkgsRUFBYXFILGtCQUFrQnJKLEVBQVNzSixhQUFhQyxTQUN6RHZILEVBQWFxSCxrQkFBa0JySixFQUFTc0osYUFBYUMsS0FBS0MsS0FDdER4SCxFQUFha0gsd0JBQXdCQyxLQUN4Q00iLCJmaWxlIjoiY3VzdG9tQWQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEJvaWxlcnBsYXRlIGNvZGUgcmVxdWlyZWQgdG8gaG9vayBpbnRvIHRoZSBBRFRFQ0ggcmljaCBtZWRpYSBsaWJyYXJ5LlxuICpcbiAqIEZvciBBUEkgZG9jdW1lbnRhdGlvbiwgcGxlYXNlIGNvbnRhY3QgY2FudmFzLWhlbHBAYWR0ZWNoLmNvbVxuICovXG4oZnVuY3Rpb24oYWRDb25maWcpIHtcblxuICAvKlxuICAgKiBWaWRpYmxlIGNoZWNrXG4gICAqIFRoaXMgYXNzaWducyB0aGUgdmlkaWJsZSBwYXJlbnQgd2luZG93IGFzIHRoZSB0YXJnZXQgd2luZG93XG4gICAqL1xuICBpZiAoIWFkQ29uZmlnLnByZXZpZXcpIHtcbiAgICBhZENvbmZpZy5hc3NldENvbnRhaW5lcnMubWFpbi5pc0V4cGFuZGFibGUgPSB0cnVlO1xuICAgIHRyeSB7XG4gICAgICB2YXIgcGFyZW50Q2hlY2sgPSB3aW5kb3cuZnJhbWVFbGVtZW50ID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgdmFyIHRhcmdldFdpbiA9IHBhcmVudENoZWNrID8gd2luZG93LmZyYW1lRWxlbWVudC5wYXJlbnROb2RlLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC5jb250ZW50V2luZG93IDogd2luZG93O1xuICAgICAgYWRDb25maWcub3ZlcnJpZGVzID0gYWRDb25maWcub3ZlcnJpZGVzIHx8IHt9O1xuICAgICAgYWRDb25maWcub3ZlcnJpZGVzLmRpc3BsYXlXaW5kb3dUYXJnZXQgPSB0YXJnZXRXaW47XG4gICAgfSBjYXRjaChlKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBmaW5kIHRhcmdldCBpZnJhbWUgaW4gcGxheWVyIGVudmlyb25tZW50OiBIYXMgdGhlIHN0cnVjdHVyZSBjaGFuZ2VkP1xcbicsIGUpO1xuICAgIH1cbiAgfVxuICBcbiAgdmFyIHJlcXVpcmVzQnJlYWtvdXQgPSBmYWxzZTtcbiAgaWYgKCFhZENvbmZpZy5vdmVycmlkZXMgfHwgYWRDb25maWcub3ZlcnJpZGVzLmRpc3BsYXlXaW5kb3dUYXJnZXQgIT0gc2VsZikge1xuICAgIGZvciAodmFyIGlkIGluIGFkQ29uZmlnLmFzc2V0Q29udGFpbmVycykge1xuICAgICAgaWYgKGFkQ29uZmlnLmFzc2V0Q29udGFpbmVycy5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9IGFkQ29uZmlnLmFzc2V0Q29udGFpbmVyc1tpZF07XG4gICAgICAgIGlmIChjb250YWluZXIudHlwZSAhPSAnaW5saW5lRGl2JyB8fCBjb250YWluZXIuaXNFeHBhbmRhYmxlKSB7XG4gICAgICAgICAgcmVxdWlyZXNCcmVha291dCA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoYWRDb25maWcub3ZlcnJpZGVzICYmIGFkQ29uZmlnLm92ZXJyaWRlcy5kaXNwbGF5V2luZG93VGFyZ2V0KSB7XG4gICAgdmFyIGRpc3BsYXlXaW5kb3dUYXJnZXQgPSBhZENvbmZpZy5vdmVycmlkZXMuZGlzcGxheVdpbmRvd1RhcmdldDtcbiAgICBkaXNwbGF5V2luZG93VGFyZ2V0ID0gKHR5cGVvZiBhZHRlY2hJZnJhbWVIYXNoQXJyYXkgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZiAhPSB0b3ApID9cbiAgICAgICAgZGlzcGxheVdpbmRvd1RhcmdldC5wYXJlbnQgOiBkaXNwbGF5V2luZG93VGFyZ2V0O1xuICB9IGVsc2Uge1xuICAgIHZhciBjYWxjdWxhdGVkVGFyZ2V0ID0gbnVsbDtcbiAgICB2YXIgY3VycmVudFdpbmRvdyA9IHBhcmVudDtcbiAgICB3aGlsZSAoY3VycmVudFdpbmRvdyAhPSB1bmRlZmluZWQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciB0YXJnZXREb2MgPSBjdXJyZW50V2luZG93LmRvY3VtZW50O1xuICAgICAgICBpZiAodGFyZ2V0RG9jKSB7XG4gICAgICAgICAgY2FsY3VsYXRlZFRhcmdldCA9IGN1cnJlbnRXaW5kb3c7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2goZSkge31cbiAgICAgIGN1cnJlbnRXaW5kb3cgPSAoY3VycmVudFdpbmRvdyA9PSB0b3ApID8gbnVsbCA6IGN1cnJlbnRXaW5kb3cucGFyZW50O1xuICAgIH1cbiAgICB2YXIgZGlzcGxheVdpbmRvd1RhcmdldCA9IGNhbGN1bGF0ZWRUYXJnZXQgfHwgdG9wO1xuICB9XG5cbiAgdmFyIHRhcmdldElzRnJpZW5kbHkgPSBmYWxzZTtcbiAgdHJ5IHtcbiAgICB2YXIgdGFyZ2V0RG9jID0gZGlzcGxheVdpbmRvd1RhcmdldC5kb2N1bWVudDtcbiAgICBpZiAodGFyZ2V0RG9jKSB7XG4gICAgICB0YXJnZXRJc0ZyaWVuZGx5ID0gdHJ1ZTtcbiAgICB9XG4gIH0gY2F0Y2goZSkge31cblxuICB2YXIgdGFyZ2V0V2luZG93ID0gKHJlcXVpcmVzQnJlYWtvdXQgJiYgKHNlbGYgIT0gdG9wICYmIHRhcmdldElzRnJpZW5kbHkpKSA/XG4gICAgICAgICAgZGlzcGxheVdpbmRvd1RhcmdldCA6IHNlbGY7XG4gIFxuICB0YXJnZXRXaW5kb3cuY29tID0gdGFyZ2V0V2luZG93LmNvbSB8fCB7fTtcbiAgdGFyZ2V0V2luZG93LmNvbS5hZHRlY2ggPSB0YXJnZXRXaW5kb3cuY29tLmFkdGVjaCB8fCB7fTtcblxuICAvKlxuICAgKiBDdXN0b21BZC5qcyBDb25zdHJ1Y3RvclxuICAgKi9cbiAgdGFyZ2V0V2luZG93LmNvbS5hZHRlY2guQWR0ZWNoQ3VzdG9tQWQkQURfSUQkID0gZnVuY3Rpb24oKSB7fTtcbiAgXG4gIC8qXG4gICAqIEluY2x1ZGUgcGFydGlhbHNcbiAgICovXG4gIC8vIENvcmUgY2xhc3NcbiAgLyoqXG4gICAqIEN1c3RvbUFkLmpzIFByb3RvdHlwZSAtIGF0dGFjaGVkIHRvIEN1c3RvbUFkIHByb3RvdHlwZVxuICAgKi9cbiAgdmFyIGN1c3RvbUFkID0gdGFyZ2V0V2luZG93LmNvbS5hZHRlY2guQWR0ZWNoQ3VzdG9tQWQkQURfSUQkO1xuICBcbiAgLy8gQWRkIHdpbmRvdyBvYmplY3RzIHRvIGVsZW1lbnRzIHByb3BlcnR5XG4gIGN1c3RvbUFkLnByb3RvdHlwZS5lbGVtID0ge307XG4gIGN1c3RvbUFkLnByb3RvdHlwZS5lbGVtLnRvcFdpbiA9IHdpbmRvdy5wYXJlbnQ7XG4gIGN1c3RvbUFkLnByb3RvdHlwZS5lbGVtLnRhcmdldFdpbmRvdyA9IHRhcmdldFdpbmRvdztcbiAgXG4gIC8vIFRvb2xraXRcbiAgLyoqXG4gICAqIEN1c3RvbSBBZCBUb29sc1xuICAgKi9cbiAgY3VzdG9tQWQucHJvdG90eXBlLnRvb2xzID0ge1xuICAgIGV2ZW50cyA6IHtcbiAgICAgIHRyaWdnZXJFdmVudCA6IGZ1bmN0aW9uKGVsLCBldmVudE5hbWUpe1xuICAgICAgICB2YXIgZXZlbnQ7XG4gICAgICAgIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudCkge1xuICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcbiAgICAgICAgICBldmVudC5pbml0RXZlbnQoZXZlbnROYW1lLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCkgey8vIElFIDwgOVxuICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTtcbiAgICAgICAgICBldmVudC5ldmVudFR5cGUgPSBldmVudE5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQuZXZlbnROYW1lID0gZXZlbnROYW1lO1xuICAgICAgICBpZiAoZWwuZGlzcGF0Y2hFdmVudCkge1xuICAgICAgICAgIGVsLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKGVsLmZpcmVFdmVudCAmJiBodG1sRXZlbnRzWydvbicrZXZlbnROYW1lXSkgey8vIElFIDwgOVxuICAgICAgICAgIGVsLmZpcmVFdmVudCgnb24nK2V2ZW50LmV2ZW50VHlwZSxldmVudCk7Ly8gY2FuIHRyaWdnZXIgb25seSByZWFsIGV2ZW50IChlLmcuICdjbGljaycpXG4gICAgICAgIH0gZWxzZSBpZiAoZWxbZXZlbnROYW1lXSl7XG4gICAgICAgICAgZWxbZXZlbnROYW1lXSgpO1xuICAgICAgICB9IGVsc2UgaWYgKGVsWydvbicrZXZlbnROYW1lXSkge1xuICAgICAgICAgIGVsWydvbicrZXZlbnROYW1lXSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYWRkRXZlbnQgOiBmdW5jdGlvbihlbCwgdHlwZSwgaGFuZGxlcil7XG4gICAgICAgIGlmIChlbC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLGhhbmRsZXIsZmFsc2UpO1xuICAgICAgICB9IGVsc2UgaWYgKGVsLmF0dGFjaEV2ZW50ICYmIGh0bWxFdmVudHNbJ29uJyt0eXBlXSl7Ly8gSUUgPCA5XG4gICAgICAgICAgZWwuYXR0YWNoRXZlbnQoJ29uJyt0eXBlLGhhbmRsZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsWydvbicrdHlwZV09aGFuZGxlcjtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlbW92ZUV2ZW50IDogZnVuY3Rpb24oZWwsIHR5cGUsIGhhbmRsZXIpe1xuICAgICAgICBpZihlbC5yZW1vdmV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsaGFuZGxlcixmYWxzZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZWwuZGV0YWNoRXZlbnQgJiYgaHRtbEV2ZW50c1snb24nK3R5cGVdKXsvLyBJRSA8IDlcbiAgICAgICAgICBlbC5kZXRhY2hFdmVudCgnb24nK3R5cGUsaGFuZGxlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWxbJ29uJyt0eXBlXT1udWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBtYXNrIDogZnVuY3Rpb24oZWxlbSwgdmFsKSB7XG4gICAgICAvLyBlbGVtLnN0eWxlLmNsaXAgPSAncmVjdCgnK3ZhbCsnKSc7XG4gICAgfSxcbiAgICBnZXRQZXJjZW50YWdlIDogZnVuY3Rpb24obnVtLCBwZXJjZW50YWdlKSB7XG4gICAgICByZXR1cm4gKG51bSAvIDEwMCkgKiBwZXJjZW50YWdlO1xuICAgIH0sXG4gICAgLypcbiAgICAgKiBSZXR1cm4gcGl4ZWwgKyBwZXJjZW50IHZhbHVlcyBmcm9tIGludGVnZXIgLyBzdHJpbmcgLCBlZyAnMTAlJ1xuICAgICAqL1xuICAgIGdldFNpemVTdHlsZSA6IGZ1bmN0aW9uKHZhbCwgc2l6ZSkge1xuICAgICAgLy8gY29uc29sZS5sb2codmFsLCBzaXplKVxuICAgICAgdmFyIHRvb2xzID0gdGhpcy50b29scztcbiAgICAgIHZhciBwcm9jZXNzZWQgPSB7fTtcbiAgICAgIHZhciBudW0gPSBwYXJzZUludCh2YWwsIDEwKTtcbiAgICAgIHZhciB2YWwgPSB2YWwuc3BsaXQobnVtKVsxXTtcbiAgICAgIGRhdGEgPSB7XG4gICAgICAgIG51bSA6IChpc05hTihwYXJzZUZsb2F0KChudW0pKSkgPyAwIDogbnVtKSxcbiAgICAgICAgdmFsIDogKHR5cGVvZiB2YWwhPT0ndW5kZWZpbmVkJyA/IHZhbCA6ICdweCcpXG4gICAgICB9XG4gICAgICBpZiAoZGF0YS52YWw9PSclJykge1xuICAgICAgICBwcm9jZXNzZWRbJ3B4J10gPSBNYXRoLnJvdW5kKChzaXplIC8gMTAwKSAqIGRhdGEubnVtKTtcbiAgICAgICAgcHJvY2Vzc2VkWydwZXJjZW50J10gPSBkYXRhLm51bTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2Nlc3NlZFsncHgnXSA9IGRhdGEubnVtO1xuICAgICAgICBwcm9jZXNzZWRbJ3BlcmNlbnQnXSA9IGRhdGEubnVtIC8gc2l6ZSAqIDEwMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwcm9jZXNzZWQ7XG4gICAgfSxcbiAgICBnZXRWaWV3cG9ydFNpemUgOiBmdW5jdGlvbih3KSB7XG4gICAgICAvLyBVc2UgdGhlIHNwZWNpZmllZCB3aW5kb3cgb3IgdGhlIGN1cnJlbnQgd2luZG93IGlmIG5vIGFyZ3VtZW50XG4gICAgICB3ID0gdyB8fCB3aW5kb3c7XG4gIFxuICAgICAgLy8gVGhpcyB3b3JrcyBmb3IgYWxsIGJyb3dzZXJzIGV4Y2VwdCBJRTggYW5kIGJlZm9yZVxuICAgICAgaWYgKHcuaW5uZXJXaWR0aCAhPSBudWxsKSByZXR1cm4geyB3OiB3LmlubmVyV2lkdGgsIGg6IHcuaW5uZXJIZWlnaHQgfTtcbiAgXG4gICAgICAvLyBGb3IgSUUgKG9yIGFueSBicm93c2VyKSBpbiBTdGFuZGFyZHMgbW9kZVxuICAgICAgdmFyIGQgPSB3LmRvY3VtZW50O1xuICAgICAgaWYgKGRvY3VtZW50LmNvbXBhdE1vZGUgPT0gXCJDU1MxQ29tcGF0XCIpXG4gICAgICAgICAgcmV0dXJuIHsgdzogZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICAgaDogZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IH07XG4gIFxuICAgICAgLy8gRm9yIGJyb3dzZXJzIGluIFF1aXJrcyBtb2RlXG4gICAgICByZXR1cm4geyB3OiBkLmJvZHkuY2xpZW50V2lkdGgsIGg6IGQuYm9keS5jbGllbnRIZWlnaHQgfTtcbiAgICB9XG4gIH07XG4gIFxuICAvKipcbiAgICogRXZlbnRzIGxpc3RcbiAgICogVGhpcyBtZXRob2QgaXMgbmV2ZXIgdXNlZCwgb25seSBoZXJlIGZvciBPTkUgdG8gcGFyc2VcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5kZWNsYXJlRXZlbnRzID0gZnVuY3Rpb24oYWR2ZXJ0KSB7XG4gICAgXG4gICAgLy8gUGFyZW50IGV2ZW50c1xuICAgIEFEVEVDSC5ldmVudCgnUllPVF9QQVJFTlRfTUVUQScpO1xuICAgIEFEVEVDSC5ldmVudCgnUllPVF9SRVNJWkUnKTtcbiAgXG4gICAgLy8gQ2hpbGQgZXZlbnRzXG4gICAgQURURUNILmV2ZW50KCdSWU9UX0NISUxEX01FVEEnKTtcbiAgXG4gIH07XG4gIFxuICAvKipcbiAgICogcHJlSW5pdCBNZXRob2RcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5wcmVJbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHdpbmRvdz09bnVsbCkgcmV0dXJuO1xuICAgIHdpbmRvdy5jb20gPSBjb20gfHwge307XG4gICAgY29tLmFkdGVjaCA9IHdpbmRvdy5jb20uYWR0ZWNoO1xuICB9O1xuICBcbiAgLyoqXG4gICAqIEluaXQgY3VzdG9tQWRcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oYWR2ZXJ0KSB7XG4gICAgXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICBcbiAgICAvLyBBRFRFQ0ggYWR2ZXJ0IGRhdGEgb2JqZWN0XG4gICAgdGhpcy5hZHZlcnQgPSBhZHZlcnQ7XG4gIFxuICAgIC8vIEVsZW1lbnRzXG4gICAgdGhpcy5lbGVtLmFkQ29udGFpbmVyID0gYWR2ZXJ0LmFzc2V0Q29udGFpbmVycy5tYWluLmFuY2hvckRpdjtcbiAgICB0aGlzLmVsZW0uYWRDb250ZW50ID0gYWR2ZXJ0LmFzc2V0Q29udGFpbmVycy5tYWluLmFuY2hvckRpdi5maXJzdENoaWxkO1xuICAgIHRoaXMuZWxlbS5hZElmcmFtZSA9IHRoaXMuZWxlbS5hZENvbnRlbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lmcmFtZScpWzBdO1xuICAgIHRoaXMuZWxlbS5hZEJvZHkgPSBkb2N1bWVudCB8fCB0aGlzLmVsZW0uYWRJZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDtcbiAgXG4gICAgLy8gQURURUNIIGxpYnJhcmllc1xuICAgIHRoaXMubGliID0ge307XG4gICAgdGhpcy5saWIudXRpbHMgPSB0YXJnZXRXaW5kb3cuY29tLmFkdGVjaC5VdGlsc18kVkVSU0lPTiQ7XG4gICAgdGhpcy5saWIuZ2xvYmFsRXZlbnRCdXMgPSB0YXJnZXRXaW5kb3cuYWR0ZWNoQWRNYW5hZ2VyXyRWRVJTSU9OJC5nbG9iYWxFdmVudEJ1cztcbiAgICB0aGlzLmxpYi5yaWNoTWVkaWFFdmVudCA9IHRhcmdldFdpbmRvdy5jb20uYWR0ZWNoLlJpY2hNZWRpYUV2ZW50XyRWRVJTSU9OJDtcbiAgXG4gICAgLy8gTWV0YSBkYXRhIHRvIHBhc3MgdG8gY2hpbGRcbiAgICB0aGlzLm1ldGFEYXRhID0ge307XG4gIFxuICAgIC8vIFNldHVwIHJlY2lldmVyXG4gICAgdGhpcy5yZWNpZXZlTWV0YSgpOyAgXG4gIH07XG4gIFxuICAvKipcbiAgICogUGFyZW50IGRhdGEgb2JqZWN0XG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUuZGF0YSA9IHtcbiAgICB0b3BQb3NpdGlvbiA6IDAsXG4gICAgc2Nyb2xsVG9wIDogMCxcbiAgICB3aW5XaWR0aCA6IDAsXG4gICAgd2luSGVpZ2h0IDogMCxcbiAgICBkb2NIZWlnaHQgOiAwXG4gIH1cbiAgXG4gIC8qKlxuICAgKiBDaGlsZCBkYXRhXG4gICAqL1xuICAvLyBjdXN0b21BZC5wcm90b3R5cGUuY2hpbGREYXRhID0ge31cbiAgXG4gIC8qKlxuICAgKiBGaXJlIHRoaXMgc3R1ZmYgd2hlbiByZWFkeSAoY2hpbGQgbWV0YSBpcyByZWNpZXZlZClcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS53aGVuUmVhZHkgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmhhbmRsZVBhcmVudERhdGEoKTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBIYW5kbGUgUGFyZW50IGRhdGFcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5oYW5kbGVQYXJlbnREYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgLy8gU2Nyb2xsIHBvc2l0aW9uXG4gICAgdGhpcy5zZXR1cFNjcm9sbERhdGEoKTtcbiAgICAvLyBHZXQgQWQgd3JhcHBlciBwb3NpdGlvbiBkYXRhXG4gICAgdGhpcy5nZXRBZFdyYXBwZXJQb3NpdGlvbigpO1xuICAgIC8vIFNldCBhZHZlcnQgd3JhcHBlciBoZWlnaHRcbiAgICB0aGlzLnNldEFkSGVpZ2h0KCk7XG4gICAgLy8gU2V0dXAgcmVzaXplIGV2ZW50XG4gICAgdGhpcy5zZXR1cFJlc2l6ZSgpO1xuICBcbiAgICAvLyBTZXR1cCBkaXNwYXRjaGVyXG4gICAgdGhpcy5zZW5kTWV0YSgpO1xuICB9XG4gIFxuICAvKipcbiAgICogRGlzcGF0Y2ggZXZlbnQgdG8gY2hpbGRcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24oZXZlbnROYW1lLCBkYXRhKSB7XG4gICAgdmFyIHJpY2hNZWRpYUV2ZW50ID0gbmV3IHRoaXMubGliLnJpY2hNZWRpYUV2ZW50KGV2ZW50TmFtZSk7XG4gICAgdmFyIGRhdGEgPSBkYXRhIHx8IHt9O1xuICAgIHJpY2hNZWRpYUV2ZW50Lm1ldGEgPSBkYXRhO1xuICAgIHRoaXMuYWR2ZXJ0LmV2ZW50QnVzLmRpc3BhdGNoRXZlbnQocmljaE1lZGlhRXZlbnQpO1xuICB9XG4gIFxuICAvKipcbiAgICogU2VuZCBtZXRhIGRhdGEgdG8gY2hpbGQgKGFkdmVydClcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5zZW5kTWV0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnUllPVF9QQVJFTlRfTUVUQScsIHNlbGYuZGF0YSk7XG4gICAgfSwgMTAwKTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBSZWNpZXZlIG1ldGEgZGF0YSBmcm9tIGNoaWxkXG4gICAqL1xuICBjdXN0b21BZC5wcm90b3R5cGUucmVjaWV2ZU1ldGEgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5hZHZlcnQuZXZlbnRCdXMuYWRkRXZlbnRMaXN0ZW5lcignUllPVF9DSElMRF9NRVRBJywgZnVuY3Rpb24oZSkge1xuICAgICAgc2VsZi5kYXRhLmRvY0hlaWdodCA9IGUubWV0YS5kb2NIZWlnaHQ7XG4gICAgICAvLyBTZXQgYWR2ZXJ0IHdyYXBwZXIgaGVpZ2h0XG4gICAgICBzZWxmLnNldEFkSGVpZ2h0KGUubWV0YS5kb2NIZWlnaHQpO1xuICAgICAgLy8gTWV0YSBpcyByZWFkeSwgc28gZmlyZVxuICAgICAgc2VsZi53aGVuUmVhZHkoKTtcbiAgICB9KTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5nZXRBZFdyYXBwZXJQb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtLmFkQ29udGFpbmVyO1xuICAgIHZhciBib2R5UmVjdCA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgIGVsZW1SZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgdG9wID0gZWxlbVJlY3QudG9wIC0gYm9keVJlY3QudG9wO1xuICAgIHRoaXMuZGF0YS50b3BQb3NpdGlvbiA9IHRvcDtcbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBcbiAgICovXG4gIGN1c3RvbUFkLnByb3RvdHlwZS5zZXR1cFNjcm9sbERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdzY3JvbGwnLCB3aGVlbCwgZmFsc2UgKTtcbiAgICBmdW5jdGlvbiBnZXRTY3JvbGxUb3AoKSB7XG4gICAgICB2YXIgZG9jID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgdmFyIHRvcCA9ICh3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jLnNjcm9sbFRvcCkgIC0gKGRvYy5jbGllbnRUb3AgfHwgMCk7XG4gICAgICByZXR1cm4gdG9wO1xuICAgIH1cbiAgICB2YXIgbGFzdE9mZnNldCA9IGdldFNjcm9sbFRvcCgpO1xuICAgIHZhciBsYXN0RGF0ZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIGZ1bmN0aW9uIHdoZWVsKGUpIHtcbiAgICAgIHNlbGYuZGF0YS5zY3JvbGxUb3AgPSBnZXRTY3JvbGxUb3AoKTtcbiAgICB9XG4gICAgdGhpcy5kYXRhLnNjcm9sbFRvcCA9IGdldFNjcm9sbFRvcCgpO1xuICB9XG4gIFxuICBjdXN0b21BZC5wcm90b3R5cGUuc2V0dXBSZXNpemUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHdpblNpemUgPSBzZWxmLmdldFdpbmRvd1NpemUoKTtcbiAgICBzZWxmLmRhdGEud2luV2lkdGggPSB3aW5TaXplLndpZHRoO1xuICAgIHNlbGYuZGF0YS53aW5IZWlnaHQgPSB3aW5TaXplLmhlaWdodDtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24oKXtcbiAgICAgIHZhciB3aW5TaXplID0gc2VsZi5nZXRXaW5kb3dTaXplKCk7XG4gICAgICBzZWxmLmRhdGEud2luV2lkdGggPSB3aW5TaXplLndpZHRoO1xuICAgICAgc2VsZi5kYXRhLndpbkhlaWdodCA9IHdpblNpemUuaGVpZ2h0O1xuICAgICAgc2VsZi5zZXRJZnJhbWVIZWlnaHQoc2VsZi5kYXRhLmRvY0hlaWdodCk7XG4gICAgICAvLyBzZWxmLmV2ZW50QnVzLmFkZFRvUXVldWUoJ3Jlc2l6ZScpO1xuICAgIH0sIHRydWUpO1xuICB9O1xuICBcbiAgY3VzdG9tQWQucHJvdG90eXBlLmdldFdpbmRvd1NpemUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdyA9IHdpbmRvdyxcbiAgICAgICAgZCA9IGRvY3VtZW50LFxuICAgICAgICBlID0gZC5kb2N1bWVudEVsZW1lbnQsXG4gICAgICAgIGcgPSBkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF0sXG4gICAgICAgIHggPSB3LmlubmVyV2lkdGggfHwgZS5jbGllbnRXaWR0aCB8fCBnLmNsaWVudFdpZHRoLFxuICAgICAgICB5ID0gdy5pbm5lckhlaWdodHx8IGUuY2xpZW50SGVpZ2h0fHwgZy5jbGllbnRIZWlnaHQ7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoIDogeCxcbiAgICAgIGhlaWdodCA6IHlcbiAgICB9O1xuICB9O1xuICBcbiAgY3VzdG9tQWQucHJvdG90eXBlLnNldEFkSGVpZ2h0ID0gZnVuY3Rpb24oaGVpZ2h0KSB7XG4gIFxuICAgIHZhciB0b3BXcmFwcGVyID0gdGhpcy5lbGVtLmFkQ29udGFpbmVyO1xuICAgIHZhciBjb250ZW50V3JhcHBlciA9IHRoaXMuZWxlbS5hZENvbnRlbnQ7XG4gICAgdmFyIGlmcmFtZSA9IGNvbnRlbnRXcmFwcGVyLmZpcnN0Q2hpbGQ7XG4gICAgdmFyIGRvY0JvZHkgPSB0aGlzLmVsZW0uZG9jQm9keTtcbiAgXG4gICAgLy8gVG9wIHdyYXBwZXJcbiAgICB0b3BXcmFwcGVyLnN0eWxlLndpZHRoID0gXCJhdXRvXCI7XG4gICAgdG9wV3JhcHBlci5zdHlsZS5oZWlnaHQgPSBcImF1dG9cIjtcbiAgXG4gICAgLy8gU3R5bGVcbiAgICBjb250ZW50V3JhcHBlci5zdHlsZS5jbGlwID0gXCJcIjtcbiAgXG4gICAgaWYgKGhlaWdodCE9PXRoaXMuZGF0YS5kb2NIZWlnaHQpIHtcbiAgXG4gICAgICBoZWlnaHQgPSB0aGlzLmRhdGEuZG9jSGVpZ2h0O1xuICBcbiAgICAgIC8vIHRvcFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gMCArIFwicHhcIjtcbiAgICAgIHRvcFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgXCJweFwiO1xuICAgICAgLy8gXG4gICAgICAvLyBjb250ZW50V3JhcHBlci5zdHlsZS5oZWlnaHQgPSAwICsgXCJweFwiO1xuICAgICAgY29udGVudFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgXCJweFwiO1xuICAgICAgLy8gXG4gICAgICAvLyBpZnJhbWUuc3R5bGUuaGVpZ2h0ID0gMCArIFwicHhcIjtcbiAgICAgIGlmcmFtZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyBcInB4XCI7XG4gICAgfVxuICB9LFxuXG4gIHRhcmdldFdpbmRvdy5hZHRlY2hDYWxsYmFja0luc3RhbmNlcyA9IHRhcmdldFdpbmRvdy5hZHRlY2hDYWxsYmFja0luc3RhbmNlcyB8fCBbXTtcbiAgdmFyIGluc3RhbmNlSW5kZXggPSB0YXJnZXRXaW5kb3cuYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXMubGVuZ3RoO1xuICB0YXJnZXRXaW5kb3cuYWR0ZWNoQ2FsbGJhY2tJbnN0YW5jZXNbaW5zdGFuY2VJbmRleF0gPSBuZXcgdGFyZ2V0V2luZG93LmNvbS5hZHRlY2guQWR0ZWNoQ3VzdG9tQWQkQURfSUQkKCk7XG5cbiAgdGFyZ2V0V2luZG93LmFkdGVjaEFkQ2FsbGJhY2tzID0gdGFyZ2V0V2luZG93LmFkdGVjaEFkQ2FsbGJhY2tzIHx8IHt9O1xuICB0YXJnZXRXaW5kb3cuYWR0ZWNoQWRDYWxsYmFja3NbYWRDb25maWcuYWRTZXJ2ZXJWYXJzLnVpZF0gPVxuICAgICAgdGFyZ2V0V2luZG93LmFkdGVjaEFkQ2FsbGJhY2tzW2FkQ29uZmlnLmFkU2VydmVyVmFycy51aWRdIHx8IFtdO1xuICB0YXJnZXRXaW5kb3cuYWR0ZWNoQWRDYWxsYmFja3NbYWRDb25maWcuYWRTZXJ2ZXJWYXJzLnVpZF0ucHVzaChcbiAgICAgIHRhcmdldFdpbmRvdy5hZHRlY2hDYWxsYmFja0luc3RhbmNlc1tpbnN0YW5jZUluZGV4XSk7XG59KShhZHRlY2hBZENvbmZpZyk7Il19
